<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>الشرقاوي | نظام إدارة المتجر</title>
    <link rel="icon" href="../images/logo.png" type="image/png">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Cairo:wght@400;700;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Quill CSS -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/toast.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#3498db">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <style>
        :root {
            --sidebar-width: 260px;
            --primary-color: #486b65;
            --primary-dark: #3a5651;
            --secondary-color: #b57a72;
            --success-color: #27ae60;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --bg-light: #f4f6f9;
            --text-main: #2c3e50;
            --text-muted: #7f8c8d;
            --card-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            --header-height: 70px;
        }

        /* Mobile Responsive Styles */
        @media (max-width: 768px) {
            :root {
                --sidebar-width: 0px;
            }

            body {
                overflow-x: hidden;
            }

            .sidebar {
                transform: translateX(100%);
                /* Hide sidebar to the right (RTL) */
                width: 260px !important;
                /* Restore width when shown */
                box-shadow: none;
                right: 0;
                overflow-x: hidden;
            }

            .sidebar.active {
                transform: translateX(0);
                box-shadow: -5px 0 25px rgba(0, 0, 0, 0.5);
                width: 260px !important;
            }

            .main-content {
                margin-right: 0;
                width: 100%;
                padding: 1rem;
                /* Smaller padding */
            }

            .page-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
                padding: 1.2rem;
            }

            .header-content {
                flex-direction: column;
                align-items: stretch;
                gap: 15px;
            }

            .header-actions {
                display: flex;
                flex-direction: column;
                /* Stack buttons */
                width: 100%;
                gap: 10px;
            }

            .header-actions .btn {
                width: 100%;
                justify-content: center;
            }

            .stats-grid {
                grid-template-columns: 1fr;
                /* 1 column for stats */
                gap: 1rem;
            }

            .card {
                padding: 1.2rem;
            }

            /* Responsive Table specialized for Mobile Cards style if needed, 
               but for now horizontal scroll is handled by .table-responsive */

            .form-row {
                flex-direction: column;
                gap: 0;
            }

            .form-group {
                width: 100%;
            }

            /* Mobile Menu Toggle Button */
            .mobile-menu-toggle {
                display: block !important;
                position: fixed;
                top: 15px;
                right: 15px;
                z-index: 1001;
                /* Above sidebar */
                background: var(--primary-color);
                color: white;
                border: none;
                padding: 10px;
                border-radius: 8px;
                box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
                cursor: pointer;
            }

            /* Overlay when sidebar is open */
            .sidebar-overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                z-index: 999;
            }

            .sidebar-overlay.active {
                display: block;
            }
        }

        .mobile-menu-toggle {
            display: none;
            /* Hidden on desktop */
        }


        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            caret-color: transparent !important;
        }

        input,
        textarea,
        select,
        [contenteditable="true"],
        [contenteditable="true"] * {
            caret-color: auto !important;
            user-select: text !important;
            -webkit-user-select: text !important;
        }

        .sidebar,
        .stat-card,
        .btn,
        .menu-item,
        .page-header,
        .sidebar-brand,
        .card,
        th,
        td,
        span,
        h1,
        h2,
        h3,
        h4,
        h5,
        h6,
        p,
        a,
        label,
        li {
            user-select: none;
            -webkit-user-select: none;
            -ms-user-select: none;
            outline: none !important;
        }

        body {
            display: flex;
            background: var(--bg-light);
            font-family: 'Cairo', sans-serif;
            color: var(--text-main);
            min-height: 100vh;
            overflow-x: hidden;
            direction: rtl;
        }

        /* Sidebar Styles */
        .sidebar {
            width: var(--sidebar-width);
            background: linear-gradient(180deg, #1c2833 0%, #2c3e50 100%);
            color: #ecf0f1;
            height: 100vh;
            position: fixed;
            right: 0;
            top: 0;
            z-index: 1000;
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: -2px 0 20px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
        }

        .sidebar-brand {
            padding: 1.5rem 1rem;
            text-align: center;
            background: rgba(0, 0, 0, 0.2);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            flex-shrink: 0;
        }

        .sidebar-menu {
            flex: 1;
            overflow-y: auto;
            padding: 1rem 0;
            scrollbar-width: thin;
            scrollbar-color: rgba(255, 255, 255, 0.2) transparent;
        }

        .sidebar-menu::-webkit-scrollbar {
            width: 4px;
        }

        .sidebar-menu::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
        }

        .menu-item {
            display: flex;
            align-items: center;
            padding: 0.9rem 1.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #bdc3c7;
            border-right: 4px solid transparent;
            font-weight: 600;
            text-decoration: none;
            user-select: none;
            -webkit-user-select: none;
            outline: none !important;
        }

        .menu-item:hover {
            background: rgba(255, 255, 255, 0.05);
            color: white;
            padding-right: 1.8rem;
        }

        .menu-item.active {
            background: rgba(52, 152, 219, 0.15);
            color: white;
            border-right-color: var(--primary-color);
        }

        .menu-item i {
            width: 25px;
            margin-left: 12px;
            font-size: 1.1rem;
            text-align: center;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-right: var(--sidebar-width);
            padding: 2rem;
            width: calc(100% - var(--sidebar-width));
            transition: all 0.3s ease;
            min-height: 100vh;
        }

        .content-section {
            display: none;
            animation: fadeIn 0.4s ease-out;
        }

        .content-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* UI Components */
        .card {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            box-shadow: var(--card-shadow);
            margin-bottom: 2rem;
            border: 1px solid rgba(0, 0, 0, 0.03);
            /* overflow: hidden; */
            /* Removing this to prevent dropdown clipping */
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #f0f0f0;
        }

        .card-header h2 {
            font-size: 1.3rem;
            color: var(--secondary-color);
            font-weight: 800;
        }

        .page-header {
            background: white;
            padding: 1.5rem 2rem;
            border-radius: 16px;
            margin-bottom: 2rem;
            box-shadow: var(--card-shadow);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .page-header h1 {
            font-size: 1.8rem;
            font-weight: 900;
            color: var(--secondary-color);
            margin: 0;
        }

        .header-main-title {
            flex: 1;
            min-width: 250px;
        }

        .header-right-side {
            display: flex;
            flex-direction: row;
            /* Force single line on desktop */
            align-items: center;
            gap: 15px;
            flex: 2;
            justify-content: flex-end;
            /* In RTL, this pushes content to the left */
        }

        .db-status-container {
            display: flex;
            gap: 12px;
            align-items: center;
            flex-wrap: wrap;
        }

        .header-actions {
            display: flex;
            align-items: center;
        }

        .show-mobile-only {
            display: none !important;
        }

        @media (max-width: 1024px) {
            .header-right-side {
                flex-direction: column;
                align-items: center !important;
                justify-content: center !important;
                width: 100% !important;
                order: 2;
                flex: none !important;
                gap: 10px;
            }

            .db-status-container {
                justify-content: center !important;
                width: 100% !important;
            }
        }

        @media (max-width: 768px) {
            .header-main-title {
                text-align: center !important;
                width: 100% !important;
                margin-bottom: 20px !important;
                flex: none !important;
            }

            .hide-mobile {
                display: none !important;
            }

            .show-mobile-only {
                display: inline-flex !important;
            }

            .header-actions {
                justify-content: center !important;
                width: 100% !important;
            }
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1.25rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: 18px;
            box-shadow: var(--card-shadow);
            border-right: 5px solid var(--primary-color);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
            justify-content: center;
            border-left: 1px solid rgba(0, 0, 0, 0.03);
            border-top: 1px solid rgba(0, 0, 0, 0.03);
            border-bottom: 1px solid rgba(0, 0, 0, 0.03);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.08);
        }

        .stat-card h3 {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-bottom: 0.4rem;
            font-weight: 700;
        }

        .stat-card p {
            font-size: 1.8rem;
            font-weight: 900;
            color: var(--secondary-color);
            margin: 0;
            letter-spacing: -0.5px;
        }

        .stat-card small {
            display: block;
            margin-top: 8px;
            font-size: 0.75rem;
            color: var(--text-muted);
            font-weight: 500;
        }

        .stat-icon-box {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 2.2rem;
            opacity: 0.08;
            color: var(--secondary-color);
            pointer-events: none;
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 13px 26px;
            border-radius: 12px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: none;
            font-family: inherit;
            font-size: 1rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            white-space: nowrap;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #2980b9 0%, #21618c 100%);
            box-shadow: 0 6px 16px rgba(52, 152, 219, 0.3);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: white;
            color: var(--secondary-color);
            border: 2px solid #e1e8ed;
        }

        .btn-secondary:hover {
            background: #f8f9fa;
            border-color: #bdc3c7;
            transform: translateY(-2px);
        }

        .btn-icon {
            width: 35px;
            height: 35px;
            padding: 0;
            border-radius: 8px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .btn-icon:hover {
            background: #eee;
            transform: translateY(-2px);
        }

        .btn-small {
            padding: 9px 18px;
            font-size: 0.9rem;
            border-radius: 10px;
        }

        .btn-delete,
        .btn-danger {
            background: #e8505b;
            color: white;
        }

        .btn-delete:hover,
        .btn-danger:hover {
            background: #d63447;
            box-shadow: 0 4px 12px rgba(232, 80, 91, 0.25);
            transform: translateY(-2px);
        }

        .btn-success {
            background: #20bf6b;
            color: white;
        }

        .btn-success:hover {
            background: #1ba05c;
            box-shadow: 0 4px 12px rgba(32, 191, 107, 0.25);
            transform: translateY(-2px);
        }

        /* Reorder Handle */
        .reorder-handle {
            cursor: move;
            color: #ccc;
            padding: 10px;
            transition: color 0.2s;
        }

        .reorder-handle:hover {
            color: var(--primary-color);
        }

        .sortable-ghost {
            opacity: 0.4;
            background-color: #f1f5f9 !important;
        }

        /* Variants Styling & Responsiveness */
        .variant-row {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr auto;
            gap: 12px;
            margin-bottom: 15px;
            align-items: end;
            background: #fff;
            padding: 15px;
            border-radius: 12px;
            border: 1px solid #e0e0e0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.02);
            transition: transform 0.2s, box-shadow 0.2s;
            position: relative;
        }

        .variant-row:hover {
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.05);
        }

        @media (max-width: 650px) {
            .variant-row {
                grid-template-columns: 1fr 1fr;
                /* 2 columns on mobile */
                gap: 15px;
                padding-bottom: 70px;
                /* Space for the delete button at bottom */
            }

            .variant-row .form-group {
                margin-bottom: 0 !important;
            }

            .variant-row .btn-delete {
                position: absolute;
                bottom: 15px;
                left: 15px;
                right: 15px;
                width: calc(100% - 30px) !important;
                height: 44px !important;
                margin-bottom: 0 !important;
                justify-content: center !important;
                background: #fff1f0 !important;
                border: 1px solid #ffa39e !important;
                display: flex !important;
                align-items: center;
                border-radius: 10px;
            }

            .variant-row .btn-delete::after {
                content: ' حذف هذا المقاس';
                font-size: 0.9rem;
                font-weight: 700;
                margin-right: 8px;
            }
        }

        .variant-row .btn-delete {
            margin-bottom: 5px;
            height: 42px;
            width: 42px;
            border-radius: 10px;
            border: none;
            background: #fff1f0;
            color: #f5222d;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .variant-row .btn-delete:hover {
            background: #ff4d4f;
            color: white;
        }

        .sortable-chosen {
            background-color: #fff !important;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .action-btn-group {
            display: flex;
            gap: 5px;
            justify-content: flex-end;
        }

        .btn-edit {
            color: #3498db;
            background: rgba(52, 152, 219, 0.1);
        }

        .btn-edit:hover {
            background: #3498db;
            color: white;
        }

        .btn-archive {
            color: white;
            background: #f39c12;
        }

        .btn-archive:hover {
            background: #e67e22;
            color: white;
        }

        .btn-trash {
            color: white;
            background: #e74c3c;
        }

        .btn-trash:hover {
            background: #c0392b;
            color: white;
        }

        .btn-move {
            color: #57606f;
            background: #f1f2f6;
        }

        .btn-move:hover {
            background: #dfe4ea;
            color: #2f3542;
        }


        .btn-view {
            color: #2ecc71;
            background: rgba(46, 204, 113, 0.1);
        }

        .btn-view:hover {
            background: #2ecc71;
            color: white;
        }

        .btn-archive {
            color: #f39c12;
            background: rgba(243, 156, 18, 0.1);
        }

        .btn-archive:hover {
            background: #f39c12;
            color: white;
        }

        .btn-print {
            color: #34495e;
            background: rgba(52, 73, 94, 0.1);
        }

        .btn-print:hover {
            background: #34495e;
            color: white;
        }

        .btn-invite {
            color: #9b59b6;
            background: rgba(155, 89, 182, 0.1);
        }

        .btn-invite:hover {
            background: #9b59b6;
            color: white;
        }

        .btn-whatsapp {
            color: #25D366;
            background: rgba(37, 211, 102, 0.1);
        }

        .btn-whatsapp:hover {
            background: #25D366;
            color: white;
        }

        /* Product Table Specifics */
        .product-img-wrapper {
            width: 70px;
            height: 70px;
            border-radius: 12px;
            overflow: hidden;
            border: 2px solid #f0f0f0;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
            transition: all 0.3s ease;
        }

        .product-img-wrapper:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
        }

        .product-img-wrapper img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .product-name-cell {
            font-weight: 600;
            color: #2c3e50;
            font-size: 0.95rem;
            line-height: 1.4;
            max-width: 300px;
        }

        .badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.875rem;
            white-space: nowrap;
        }

        .badge-price {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }

        .badge-category {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            box-shadow: 0 2px 8px rgba(240, 147, 251, 0.3);
        }

        /* Editable Badge Styles */
        .editable-badge {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            outline: none;
        }

        .editable-badge:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            filter: brightness(1.1);
        }

        .editable-badge:focus {
            box-shadow: 0 0 0 4px rgba(255, 255, 255, 0.3), 0 4px 20px rgba(0, 0, 0, 0.3);
            transform: scale(1.08);
            filter: brightness(1.15);
        }

        .editable-badge::before {
            content: '✏️';
            position: absolute;
            top: -8px;
            right: -8px;
            font-size: 0.7rem;
            opacity: 0;
            transition: opacity 0.2s;
            pointer-events: none;
        }

        .editable-badge:hover::before {
            opacity: 1;
        }

        .btn-action-group {
            display: flex;
            gap: 6px;
            justify-content: flex-end;
            align-items: center;
        }

        /* Enhanced Table Rows */
        #products-table tr {
            transition: all 0.2s ease;
        }

        #products-table tr:hover {
            background: linear-gradient(to right, #f8f9ff 0%, #fff 100%);
            transform: translateX(-2px);
        }

        #products-table td {
            vertical-align: middle;
            padding: 1.2rem 1rem;
        }

        #products-table th {
            font-weight: 700;
            text-transform: none;
            letter-spacing: 0;
            font-size: 0.9rem;
            color: #2c3e50;
            background: linear-gradient(to bottom, #fafbfc 0%, #f5f6f8 100%);
            border-bottom: 2px solid #e1e8ed;
        }

        /* Tables */
        .table-responsive {
            width: 100%;
            overflow-x: auto;
            /* overflow-y: visible; */
            /* This doesn't work alone with overflow-x: auto */
            background: white;
            border-radius: 12px;
            border: 1px solid #eee;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.02);
            /* Hide scrollbar but keep functionality */
            -ms-overflow-style: none;
            scrollbar-width: none;
            position: relative;
        }

        /* Allow dropdowns to break out of the responsive table container */
        .table-responsive:has(.status-dropdown.active) {
            overflow: visible !important;
            z-index: 100;
        }

        /* Ensure parents also don't clip */
        .card:has(.status-dropdown.active) {
            overflow: visible !important;
            z-index: 100;
        }

        .content-section:has(.status-dropdown.active) {
            z-index: 100;
        }

        .table-responsive::-webkit-scrollbar {
            display: none;
        }

        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            min-width: 700px;
        }

        /* Responsive Table Adjustments */
        @media (max-width: 600px) {
            table {
                min-width: 550px;
            }

            /* Hide Category column on very small screens to save space */
            .badge-category,
            th:nth-child(5),
            td:nth-child(5) {
                display: none;
            }
        }

        th,
        td {
            padding: 1rem 1.2rem;
            text-align: right;
            border-bottom: 1px solid #f0f0f0;
            vertical-align: middle;
        }

        th {
            background: #fafbfc;
            font-weight: 700;
            color: var(--secondary-color);
            position: sticky;
            top: 0;
            letter-spacing: 0.3px;
            text-transform: uppercase;
            font-size: 0.85rem;
        }

        /* Pagination Styles */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            margin-top: 2rem;
            flex-wrap: wrap;
        }

        .page-btn {
            min-width: 40px;
            height: 40px;
            padding: 0 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
            background: white;
            border: 1.5px solid #edf2f7;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            color: var(--text-main);
            font-family: 'Cairo', sans-serif;
        }

        .page-btn.active {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            border-color: transparent;
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }

        .page-btn:hover:not(.active) {
            background: #f8fafc;
            border-color: #cbd5e0;
            transform: translateY(-2px);
        }

        .page-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Modern Table Body */
        tbody tr {
            transition: all 0.2s ease;
        }

        tbody tr:hover {
            background-color: #f8fbff;
        }

        tbody tr:last-child td {
            border-bottom: none;
        }

        /* Modals */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 1rem;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 2.5rem;
            border-radius: 20px;
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            animation: modalSlideUp 0.3s ease-out;
        }

        @keyframes modalSlideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Form Controls */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 700;
        }

        .form-control,
        input[type="text"],
        input[type="email"],
        input[type="password"],
        input[type="number"],
        select,
        textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2.5px solid #eee;
            border-radius: 10px;
            font-family: inherit;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .form-control:focus {
            border-color: var(--primary-color);
            outline: none;
            background: white;
        }

        /* Custom Status Dropdown */
        .status-dropdown {
            position: relative;
            display: inline-block;
            width: 150px;
        }

        .status-trigger {
            padding: 8px 15px;
            border-radius: 20px;
            color: white;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            font-size: 0.85rem;
            width: 100%;
        }

        .status-trigger:hover {
            transform: scale(1.02);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
        }

        .status-trigger i {
            font-size: 0.8rem;
            transition: transform 0.3s;
        }

        .status-dropdown.active .status-trigger i {
            transform: rotate(180deg);
        }

        .status-menu {
            position: absolute;
            top: 100%;
            left: 0;
            min-width: 160px;
            background: white;
            border-radius: 12px;
            margin-top: 8px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            z-index: 99999 !important;
            overflow: hidden;
            display: none;
            transform-origin: top;
            animation: dropdownZoom 0.2s ease-out;
            border: 1px solid #eee;
        }

        @keyframes dropdownZoom {
            from {
                opacity: 0;
                transform: scaleY(0.8);
            }

            to {
                opacity: 1;
                transform: scaleY(1);
            }
        }

        .status-dropdown.active .status-menu {
            display: block;
        }

        .status-option {
            padding: 10px 15px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #2c3e50;
            font-weight: 600;
            font-size: 0.85rem;
            border-bottom: 1px solid #f8f9fa;
        }

        .status-option:last-child {
            border-bottom: none;
        }

        .status-option:hover {
            background: #f8f9fa;
            padding-right: 20px;
        }

        .status-option i {
            width: 18px;
            text-align: center;
        }

        /* Mobile Adjustments (MASTER BREAKPOINT) */
        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(100%);
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .main-content {
                margin-right: 0;
                width: 100%;
                padding: 1.5rem;
                padding-top: 5rem;
            }

            .sidebar-overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.4);
                z-index: 999;
                backdrop-filter: blur(3px);
            }

            .sidebar-overlay.active {
                display: block;
            }

            .mobile-toggle {
                display: flex !important;
                position: fixed;
                top: 1rem;
                right: 1rem;
                z-index: 1001;
                background: var(--secondary-color);
                color: white;
                width: 45px;
                height: 45px;
                border-radius: 12px;
                align-items: center;
                justify-content: center;
                border: none;
                cursor: pointer;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            }
        }

        @media (max-width: 768px) {
            .page-header {
                flex-direction: column !important;
                align-items: stretch !important;
                text-align: center;
                padding: 1.5rem 1rem !important;
            }

            .header-content {
                flex-direction: column !important;
                gap: 15px !important;
            }

            .header-actions {
                width: 100% !important;
                justify-content: center !important;
                flex-direction: row !important;
            }

            .header-actions .btn {
                flex: 1 !important;
                min-width: auto !important;
            }

            .stats-grid {
                grid-template-columns: 1fr !important;
            }

            .modal-content {
                padding: 1.5rem !important;
            }

            .table-responsive table {
                min-width: 500px;
            }

            .table-compact table {
                min-width: 100% !important;
            }

            .table-compact th,
            .table-compact td {
                padding: 10px 5px !important;
                font-size: 0.8rem !important;
            }

            .toolbar {
                flex-direction: column !important;
                gap: 15px !important;
                align-items: stretch !important;
                flex-wrap: wrap !important;
            }

            .search-box {
                width: 100% !important;
                min-width: 100% !important;
                flex: none !important;
            }

            .toolbar-actions {
                width: 100% !important;
                flex-wrap: wrap !important;
                justify-content: space-between !important;
            }

            .toolbar .btn {
                flex: 1 !important;
                min-width: 120px !important;
            }

            .checkbox-label {
                width: 100% !important;
                justify-content: center !important;
            }

            .divider {
                display: none !important;
            }

            .grid-2-col,
            .grid-2-col-wide {
                grid-template-columns: 1fr !important;
            }

            .bulk-actions {
                flex-wrap: wrap !important;
                justify-content: center !important;
            }

            .btn-small {
                flex: 1 !important;
            }
        }

        @media (max-width: 480px) {
            .main-content {
                padding: 1rem !important;
                padding-top: 4.5rem !important;
            }

            .stat-card p {
                font-size: 1.8rem !important;
            }

            .page-header h1 {
                font-size: 1.5rem !important;
            }

            .btn {
                padding: 10px 18px !important;
                font-size: 0.9rem !important;
            }

            .header-actions .btn {
                font-size: 0.85rem !important;
                padding: 10px 15px !important;
            }

            .toolbar {
                padding: 15px !important;
            }

            .card {
                padding: 1rem !important;
            }

            .form-group label {
                font-size: 0.9rem !important;
            }

            .stats-grid {
                gap: 1rem !important;
            }
        }

        /* Specific Component Styles */
        .keyword-tag {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: #fff;
            color: #3498db;
            padding: 8px 18px;
            border-radius: 12px;
            margin: 6px;
            font-size: 0.95rem;
            font-weight: bold;
            border: 2px solid #3498db;
            box-shadow: 0 2px 5px rgba(52, 152, 219, 0.1);
            transition: all 0.2s;
        }

        .keyword-tag:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(52, 152, 219, 0.2);
        }

        .suggested-keyword {
            cursor: pointer;
            background: #f1f9f1;
            color: #27ae60;
            padding: 8px 18px;
            border-radius: 50px;
            border: 2px solid #d4edda;
            font-weight: bold;
            font-size: 0.9rem;
            display: inline-block;
            margin: 6px;
            transition: all 0.2s;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.03);
        }

        .suggested-keyword:hover {
            background: #d4edda;
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08);
            border-color: #27ae60;
        }

        .remove-keyword {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
        }

        .image-previews {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .preview-item {
            width: 80px;
            height: 80px;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
        }

        .preview-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .btn-action-modern {
            width: 34px;
            height: 34px;
            border-radius: 8px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border: none;
            cursor: pointer;
            transition: transform 0.2s;
            margin: 0 3px;
        }

        .btn-action-modern:hover {
            transform: scale(1.1);
        }

        /* --- NEW UTILITIES & RESTORED STYLES --- */

        /* Text Colors */
        .text-muted {
            color: var(--text-muted) !important;
        }

        .text-success {
            color: var(--success-color) !important;
        }

        .text-danger {
            color: var(--danger-color) !important;
        }

        .text-warning {
            color: var(--warning-color) !important;
        }

        /* Button Variants */
        .btn-delete {
            background: #ff4757;
            color: white;
        }

        .btn-delete:hover {
            background: #ff6b81;
            box-shadow: 0 4px 12px rgba(255, 71, 87, 0.4);
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            background: #219150;
            box-shadow: 0 4px 12px rgba(39, 174, 96, 0.4);
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 0.85rem;
        }

        .btn-block {
            width: 100%;
            display: flex;
        }

        /* Stat Card Colors */
        .stat-card.success {
            border-right-color: var(--success-color);
        }

        .stat-card.danger {
            border-right-color: var(--danger-color);
        }

        .stat-card.warning {
            border-right-color: var(--warning-color);
        }

        .stat-card.info {
            border-right-color: var(--primary-color);
        }

        /* Default */

        .stat-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .icon-bg {
            font-size: 2.5rem;
            opacity: 0.15;
        }

        /* Status & Indicators */
        .status-indicator {
            font-weight: bold;
            font-size: 0.9rem;
            background: white;
            padding: 10px 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
            gap: 8px;
            border: 1px solid #f0f0f0;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #95a5a6;
        }

        .status-dot.connected {
            background: var(--success-color);
        }

        .status-dot.disconnected {
            background: var(--danger-color);
        }

        /* Toolbar System */
        .toolbar {
            display: flex;
            flex-wrap: nowrap;
            gap: 20px;
            background: white;
            padding: 20px 25px;
            border-radius: 16px;
            border: 1px solid #f0f0f0;
            margin-bottom: 25px;
            align-items: center;
            box-shadow: var(--card-shadow);
        }

        .search-box {
            position: relative;
            flex: 1;
            min-width: 250px;
        }

        .search-box input {
            padding-right: 45px;
            padding-left: 18px;
            padding-top: 14px;
            padding-bottom: 14px;
            border-radius: 12px;
            font-size: 0.95rem;
            width: 100%;
        }

        .search-box i {
            position: absolute;
            right: 18px;
            top: 50%;
            transform: translateY(-50%);
            color: #bdc3c7;
            font-size: 1.1rem;
        }

        .toolbar-actions {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-shrink: 0;
            flex-wrap: nowrap;
        }

        .divider {
            width: 1px;
            height: 30px;
            background: #ddd;
            margin: 0 8px;
            flex-shrink: 0;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.95rem;
            cursor: pointer;
            user-select: none;
            font-weight: 500;
            padding: 10px 16px;
            border-radius: 10px;
            transition: all 0.2s;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .checkbox-label:hover {
            background: #f8f9fa;
        }

        /* Bulk Actions */
        .bulk-actions {
            display: none;
            align-items: center;
            gap: 12px;
            background: #fff5f5;
            padding: 12px 20px;
            border-radius: 12px;
            border: 1px solid #ffe3e3;
            animation: fadeIn 0.3s;
            margin-top: 15px;
            width: 100%;
        }

        .bulk-actions.active {
            display: flex;
        }

        .selected-count {
            font-size: 0.95rem;
            font-weight: bold;
            color: var(--danger-color);
            margin-left: auto;
        }

        /* Layout Grids */
        .grid-2-col {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .grid-2-col-wide {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
        }

        .grid-3-col {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .h-fit {
            height: fit-content;
        }

        /* SEO Cards */
        .resources-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .seo-resource-card {
            display: block;
            text-decoration: none;
            background: white;
            border-radius: 12px;
            transition: all 0.3s ease;
            border: 1px solid #f0f0f0;
        }

        .seo-resource-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05);
            border-color: var(--primary-color);
        }

        .resource-content {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 20px;
        }

        .resource-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .resource-icon i {
            color: white;
            font-size: 1.5rem;
        }

        .icon-google {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .icon-bing {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .icon-speed {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .icon-trends {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        }

        .guide-box {
            background: #fff8e1;
            border: 1px solid #ffecb3;
            border-radius: 12px;
            padding: 25px;
            margin-top: 25px;
        }

        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        /* Image Drop Zone */
        .drop-zone {
            border: 2px dashed #ddd;
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: #fafafa;
        }

        .drop-zone:hover {
            border-color: var(--primary-color);
            background: #f0f9ff;
        }

        .icon-upload {
            font-size: 3rem;
            color: #bdc3c7;
            margin-bottom: 1rem;
            display: block;
        }

        /* --- MORE UTILITIES FOR SECTIONS --- */
        .section-title {
            font-size: 1.1rem;
            color: var(--secondary-color);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e1e8ed;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section-title.border-warning {
            border-bottom-color: #f39c12;
        }

        .section-title.border-primary {
            border-bottom-color: #3498db;
        }

        .section-title.border-success {
            border-bottom-color: #27ae60;
        }

        .section-title.border-danger {
            border-bottom-color: #e74c3c;
        }

        .icon-warning {
            color: var(--warning-color);
        }

        .icon-primary {
            color: var(--primary-color);
        }

        .icon-success {
            color: var(--success-color);
        }

        .icon-danger {
            color: var(--danger-color);
        }

        .icon-info {
            color: #3498db;
        }

        .icon-margin {
            margin-left: 8px;
        }

        .info-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #eee;
            margin-bottom: 15px;
        }

        .info-card.border-success {
            border-right: 4px solid var(--success-color);
        }

        .info-card.border-primary {
            border-right: 4px solid var(--primary-color);
        }

        .info-card h4 {
            margin-bottom: 10px;
            font-weight: 700;
            display: flex;
            align-items: center;
        }

        .info-card .description {
            margin-bottom: 15px;
            font-size: 0.95rem;
        }

        .form-group-box {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #ddd;
            margin-bottom: 1rem;
        }

        /* Generic Utilities */
        .d-flex {
            display: flex;
        }

        .align-items-center {
            align-items: center;
        }

        .justify-content-between {
            justify-content: space-between;
        }

        .gap-2 {
            gap: 0.5rem;
        }

        .mt-4 {
            margin-top: 1.5rem;
        }

        .pt-4 {
            padding-top: 1.5rem;
        }

        .border-top {
            border-top: 1px solid #eee;
        }

        .p-3 {
            padding: 1rem;
        }

        .text-lg {
            font-size: 1.1rem;
        }

        /* Stats Filter Bar */
        .stats-filter-bar {
            background: white;
            padding: 15px 20px;
            border-radius: 15px;
            box-shadow: var(--card-shadow);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
            border: 1px solid #f0f0f0;
        }

        .date-inputs {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }

        .date-inputs input {
            max-width: 160px;
        }

        .chart-container {
            margin-top: 10px;
            min-height: 300px;
        }

        @media (max-width: 768px) {
            .stats-filter-bar {
                flex-direction: column;
                align-items: stretch;
                padding: 20px;
            }

            .date-inputs {
                flex-direction: column;
                gap: 10px;
            }

            .date-inputs input {
                max-width: 100%;
            }

            .date-inputs span {
                text-align: center;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }

            .stat-card {
                padding: 1.2rem 1rem;
            }

            .stat-card p {
                font-size: 1.4rem;
            }

            .stat-icon-box {
                font-size: 1.8rem;
                left: 10px;
            }
        }

        /* Mobile Menu Toggle Button (Specific) */
        .mobile-menu-toggle {
            display: none;
            position: fixed;
            top: 15px;
            right: 15px;
            z-index: 2000;
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 14px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .mobile-menu-toggle:active {
            transform: scale(0.95);
        }

        /* Overlay */
        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 998;
            backdrop-filter: blur(2px);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .sidebar-overlay.active {
            display: block;
            opacity: 1;
        }

        @media (max-width: 768px) {
            .mobile-menu-toggle {
                display: block;
            }

            /* Adjustments for modals on mobile */
            .modal-content {
                padding: 1.5rem;
                margin: 1rem;
                max-height: 85vh;
                width: calc(100% - 2rem);
            }

            /* Adjustments for tables */
            .table-responsive {
                border-radius: 8px;
                box-shadow: none;
                border: 1px solid #eee;
            }

            th,
            td {
                padding: 0.8rem;
                font-size: 0.9rem;
            }

            .product-img-wrapper {
                width: 50px;
                height: 50px;
            }

            /* Status dropdown on mobile */
            .status-trigger {
                padding: 6px 10px;
                font-size: 0.8rem;
                width: 100%;
                min-width: 110px;
            }
        }

        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .stat-card p {
                font-size: 1.2rem;
            }

            .hide-mobile {
                display: none !important;
            }
        }

        /* Permissions Grid Styling */
        .permissions-card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
            gap: 12px;
            margin-top: 10px;
        }

        .perm-card {
            position: relative;
            cursor: pointer;
            border: 2px solid #f0f0f0;
            border-radius: 15px;
            padding: 15px 10px;
            text-align: center;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            background: #fff;
            display: block;
        }

        .perm-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary-color);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05);
        }

        .perm-card input[type="checkbox"] {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }

        .perm-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .perm-content i {
            font-size: 1.5rem;
            color: #bdc3c7;
            transition: color 0.3s;
        }

        .perm-content span {
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--secondary-color);
        }

        /* Checked State */
        .perm-card input:checked+.perm-content i {
            color: var(--primary-color);
        }

        .perm-card input:checked~.perm-content span {
            color: var(--primary-color);
        }

        .perm-card:has(input:checked) {
            border-color: var(--primary-color);
            background: rgba(52, 152, 219, 0.05);
        }

        .all-perms-card:has(input:checked) {
            background: linear-gradient(135deg, rgba(46, 204, 113, 0.1) 0%, rgba(39, 174, 96, 0.1) 100%);
            border-color: var(--success-color);
        }

        .all-perms-card:has(input:checked) i,
        .all-perms-card:has(input:checked) span {
            color: var(--success-color) !important;
        }

        @media (max-width: 480px) {
            .permissions-card-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Export & Filter Styling */
        .filter-tabs {
            display: flex;
            background: #f0f2f5;
            padding: 4px;
            border-radius: 12px;
            gap: 4px;
        }

        .filter-tab {
            padding: 8px 20px;
            border-radius: 9px;
            cursor: pointer;
            font-weight: 700;
            color: #7f8c8d;
            transition: all 0.2s ease;
            white-space: nowrap;
            text-align: center;
            min-width: 140px;
            /* توسيع سنه حسب طلب المستخدم */
        }

        .filter-tab.active {
            background: white;
            color: var(--primary-color);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
        }

        .export-field-card {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 15px;
            background: #fff;
            border: 2px solid #f0f0f0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .export-field-card:hover {
            border-color: var(--primary-color);
            background: rgba(52, 152, 219, 0.02);
        }

        .export-field-card input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .export-field-card span {
            font-weight: 700;
            font-size: 0.95rem;
            color: var(--secondary-color);
        }

        @media (max-width: 768px) {
            .filter-tab {
                min-width: 120px;
                padding: 10px 10px;
                font-size: 0.85rem;
            }
        }
    </style>
</head>

<body>
    <div class="sidebar-overlay" id="sidebar-overlay" onclick="toggleSidebar()"></div>
    <button class="mobile-menu-toggle" onclick="toggleSidebar()">
        <i class="fas fa-bars"></i>
    </button>

    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-brand">
            <img src="../images/logo.png" alt="الشرقاوي"
                style="height: 45px; width: 45px; border-radius: 8px; margin-left: 10px;">
            <span style="font-size: 1.4rem; font-weight: 800; letter-spacing: -0.5px;">الشرقاوي</span>
            <p style="font-size: 0.75rem; color: #bdc3c7; margin-top: 5px;">لوحة تحكم الإدارة</p>
        </div>
        <div class="sidebar-menu">
            <div class="menu-item active" onclick="showSection('dashboard')">
                <i class="fas fa-home"></i>
                <span>الرئيسية</span>
            </div>
            <div class="menu-item" onclick="showSection('products')">
                <i class="fas fa-box"></i>
                <span>المنتجات</span>
            </div>
            <div class="menu-item" onclick="showSection('orders')" style="position: relative;">
                <i class="fas fa-shopping-cart"></i>
                <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
                    <span>الطلبات</span>
                    <span id="orders-badge"
                        style="background: #e74c3c; color: white; padding: 2px 6px; border-radius: 10px; font-size: 0.7rem; font-weight: bold; display: none;">0</span>
                </div>
            </div>
            <div class="menu-item" onclick="showSection('customers')">
                <i class="fas fa-users"></i>
                <span>العملاء</span>
            </div>
            <div class="menu-item" onclick="showSection('abandoned')">
                <i class="fas fa-shopping-basket"></i>
                <span>السلّات المتروكة</span>
            </div>
            <div class="menu-item" id="menu-shipping" onclick="showSection('shipping')">
                <i class="fas fa-truck"></i>
                <span>الشحن</span>
            </div>
            <div class="menu-item" id="menu-staff" onclick="showSection('staff')">
                <i class="fas fa-users-cog"></i>
                <span>الإدارة والموظفين</span>
            </div>
            <div class="menu-item" onclick="showSection('discounts')">
                <i class="fas fa-ticket-alt"></i>
                <span>الخصومات</span>
            </div>
            <div class="menu-item" onclick="showSection('seo')">
                <i class="fas fa-search"></i>
                <span>تحسين محركات البحث (SEO)</span>
            </div>
            <div class="menu-item" onclick="showSection('settings')">
                <i class="fas fa-cog"></i>
                <span>الإعدادات</span>
            </div>
            <div class="menu-item" id="menu-app-security" onclick="showSection('app-security')"
                style="background: rgba(243, 156, 18, 0.1); color: #f39c12; display: none;">
                <i class="fas fa-shield-halved"></i>
                <span>أمان التطبيق (PIN)</span>
            </div>
            <div class="menu-item" onclick="showSection('stats')">
                <i class="fas fa-chart-line"></i>
                <span>الإحصائيات</span>
            </div>
            <div class="menu-item" onclick="showSection('moderation')">
                <i class="fas fa-comment-dots"></i>
                <span>مراجعة التقييمات</span>
                <span id="pending-reviews-count" class="badge"
                    style="display: none; background: #e74c3c; margin-right: 5px;">0</span>
            </div>
            <!-- Install App Button (Hidden by default, shown via JS) -->
            <div id="install-app-btn" class="menu-item"
                style="display: none; color: #2ecc71; font-weight: bold; margin-top: auto; border-top: 1px solid rgba(255,255,255,0.1);">
                <i class="fas fa-download"></i>
                <span>تثبيت التطبيق</span>
            </div>

            <div class="menu-item" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>
                <span>تسجيل الخروج</span>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Dashboard Section -->
        <div id="section-dashboard" class="content-section active">
            <div class="page-header">
                <div class="header-main-title">
                    <h1>لوحة التحكم</h1>
                    <p class="text-muted">نظرة عامة على المتجر</p>
                </div>
                <div class="header-right-side">
                    <div id="db-connection-status" class="db-status-container">
                        <!-- Indicators will be injected here -->
                    </div>
                    <div class="header-actions">
                        <button class="btn btn-secondary" onclick="syncCloudData()" id="sync-btn"
                            style="background: linear-gradient(135deg, #1abc9c 0%, #16a085 100%); border: none; color: white;">
                            <i class="fas fa-sync-alt"></i> <span class="hide-mobile">مزامنة السحاب</span><span
                                class="show-mobile-only">مزامنة</span>
                        </button>
                    </div>
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card info">
                    <h3>إجمالي الطلبات</h3>
                    <p id="total-orders">0</p>
                </div>
                <div class="stat-card success">
                    <h3>إجمالي الإيرادات</h3>
                    <p id="total-revenue">0 ج.م</p>
                </div>
                <div class="stat-card danger">
                    <h3>المنتجات</h3>
                    <p id="total-products">0</p>
                </div>
                <div class="stat-card warning">
                    <h3>العملاء</h3>
                    <p id="total-customers">0</p>
                </div>
            </div>

            <!-- Recent Orders Card -->
            <div class="card" style="margin-top: 2rem;">
                <div class="card-header">
                    <h2><i class="fas fa-history" style="margin-left: 10px; color: #3498db;"></i> أحدث الطلبات</h2>
                    <button class="btn btn-small btn-secondary" onclick="showSection('orders')">عرض الكل</button>
                </div>
                <div class="table-responsive">
                    <table>
                        <thead>
                            <tr>
                                <th style="width: 40px;"><input type="checkbox" disabled></th>
                                <th>رقم الطلب</th>
                                <th>التاريخ</th>
                                <th>العميل</th>
                                <th>المبلغ</th>
                                <th>الحالة</th>
                                <th>الإجراء</th>
                            </tr>
                        </thead>
                        <tbody id="dashboard-orders-table"></tbody>
                    </table>
                </div>
            </div>
        </div>


        <!-- Products Section -->
        <div id="section-products" class="content-section">
            <div class="page-header"
                style="background: transparent; box-shadow: none; padding: 0; margin-bottom: 2rem; flex-direction: row; align-items: center;">
                <div class="header-content"
                    style="display: flex; justify-content: space-between; align-items: center; width: 100%; flex-direction: row;">
                    <h1
                        style="display: flex; align-items: center; gap: 15px; font-size: 2.2rem; font-weight: 900; color: #b57a72; margin: 0;">
                        إدارة المنتجات <i class="fas fa-box" style="color: #3498db;"></i>
                    </h1>
                    <div class="header-actions" style="display: flex; gap: 12px;">
                        <button class="btn btn-danger" onclick="adminClearAllProducts()"
                            style="background: #e74c3c; border: none; box-shadow: 0 4px 12px rgba(231, 76, 60, 0.3); font-weight: 800; padding: 12px 25px;">
                            <i class="fas fa-trash-alt" style="margin-left: 8px;"></i>حذف الكل
                        </button>
                        <button class="btn btn-primary" onclick="openProductModal()"
                            style="background: #3498db; border: none; box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3); font-weight: 800; padding: 12px 25px;">
                            <i class="fas fa-plus"></i> إضافة منتج جديد
                        </button>
                    </div>
                </div>
            </div>

            <div class="toolbar"
                style="background: white; border-radius: 20px; padding: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); border: 1px solid #f0f0f0; display: flex; justify-content: space-between; align-items: center; gap: 20px; margin-bottom: 25px;">
                <div class="search-box" style="flex: 1; max-width: 450px; position: relative;">
                    <input type="text" id="p-search" placeholder="بحث باسم المنتج..."
                        oninput="productsCurrentPage=1; refreshProducts()" class="form-control"
                        style="padding-right: 45px; border-radius: 12px; height: 50px; background: #fff; border: 1px solid #eee; width: 100%;">
                    <i class="fas fa-search"
                        style="position: absolute; right: 18px; top: 50%; transform: translateY(-50%); color: #bdc3c7; font-size: 1.2rem;"></i>
                </div>

                <div class="toolbar-actions" style="display: flex; align-items: center; gap: 15px; flex-shrink: 0;">
                    <label
                        style="display: flex; align-items: center; gap: 10px; cursor: pointer; border: 1px solid #eee; padding: 8px 15px; border-radius: 10px;">
                        <input type="checkbox" id="show-archived" onchange="productsCurrentPage=1; refreshProducts()"
                            style="width: 18px; height: 18px;">
                        <span style="font-weight: 700; color: #2c3e50; font-size: 0.9rem;">عرض المؤرشفة</span>
                    </label>
                    <div style="width: 1px; height: 30px; background: #eee; margin: 0 5px;"></div>
                    <button class="btn" onclick="triggerImport('products')"
                        style="background: #95a5a6; color: white; border: none; font-weight: 800; padding: 12px 25px; border-radius: 12px; display: flex; align-items: center; gap: 8px; opacity: 0.8;">
                        استيراد <i class="fas fa-file-import"></i>
                    </button>
                    <button class="btn" onclick="openExportModal('products')"
                        style="background: #1abc9c; color: white; border: none; font-weight: 800; padding: 12px 25px; border-radius: 12px; display: flex; align-items: center; gap: 8px;">
                        استخراج <i class="fas fa-file-export"></i>
                    </button>
                </div>
            </div>

            <div id="products-bulk-actions" class="bulk-actions"
                style="background: linear-gradient(135deg, #fff5f5 0%, #ffe3e3 100%); border: 2px solid #e74c3c; border-radius: 12px; margin-bottom: 20px;">
                <span class="selected-count"><span id="products-selected-count">0</span> محدد</span>
                <button class="btn btn-small btn-delete" onclick="bulkDelete('products')">
                    <i class="fas fa-trash"></i> حذف المحدد
                </button>
                <button class="btn btn-small btn-secondary" onclick="bulkArchive('products')">
                    <i class="fas fa-archive"></i> أرشفة المحدد
                </button>
                <button id="move-page-btn" class="btn btn-small btn-move" onclick="moveProductToPage()"
                    style="background: #6c5ce7; color: white;">
                    <i class="fas fa-random"></i> نقل المحدد لصفحة...
                </button>
            </div>
            <input type="file" id="import-input" style="display: none;" accept=".xlsx, .xls">

            <div class="card" style="margin-top: 25px; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.08);">
                <div class="table-responsive">
                    <table>
                        <thead>
                            <tr>
                                <th style="width: 20px;"></th>
                                <th style="width: 30px; text-align: center;"><input type="checkbox"
                                        id="select-all-products" onchange="toggleSelectAll('products')"></th>
                                <th style="width: 50px;">صورة</th>
                                <th style="min-width: 150px;">الاسم</th>
                                <th style="width: 80px;">الكود</th>
                                <th style="width: 90px;">السعر</th>
                                <th style="width: 60px;">الكمية</th>
                                <th style="width: 100px;">القسم <i class="fas fa-plus"
                                        style="cursor: pointer; color: #9b59b6; margin-right: 2px; font-size: 0.7rem;"
                                        onclick="addNewCategoryPrompt()" title="إضافة مجموعة جديدة"></i></th>
                                <th style="text-align: center; width: 145px;">الإجراءات</th>
                            </tr>
                            <style>
                                #products-table td {
                                    padding: 10px 8px !important;
                                    /* Comfortable medium padding */
                                    vertical-align: middle;
                                }
                            </style>
                        </thead>
                        <tbody id="products-table"></tbody>
                    </table>
                </div>
                <!-- Products Pagination Container -->
                <div id="products-pagination" class="pagination"></div>
            </div>
        </div>

        <!-- Orders Section -->
        <div id="section-orders" class="content-section">
            <div class="page-header"
                style="background: transparent; box-shadow: none; padding: 0; margin-bottom: 2rem; flex-direction: row; align-items: center;">
                <div class="header-content"
                    style="display: flex; justify-content: space-between; align-items: center; width: 100%; flex-direction: row;">
                    <h1
                        style="display: flex; align-items: center; gap: 15px; font-size: 2.2rem; font-weight: 900; color: #b57a72; margin: 0;">
                        إدارة الطلبات <i class="fas fa-shopping-cart" style="color: #e67e22;"></i>
                    </h1>
                    <div class="header-actions" style="display: flex; gap: 12px;">
                        <button class="btn btn-success" onclick="openExportModal('orders')"
                            style="background: #2ecc71; border: none; box-shadow: 0 4px 12px rgba(46, 204, 113, 0.3); font-weight: 800; padding: 12px 25px;">
                            استخراج البيانات <i class="fas fa-file-excel"></i>
                        </button>
                        <button class="btn btn-primary" onclick="openManualOrderModal()"
                            style="background: #3498db; border: none; box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3); font-weight: 800; padding: 12px 25px;">
                            <i class="fas fa-plus"></i> إضافة طلب يدوي
                        </button>
                    </div>
                </div>
            </div>

            <div class="toolbar">
                <div class="search-box" style="flex: 2;">
                    <input type="text" id="o-search" placeholder="بحث برقم الطلب، اسم العميل، أو الهاتف..."
                        oninput="refreshOrders()" class="form-control">
                    <i class="fas fa-search"></i>
                </div>

                <div class="toolbar-actions" style="flex: 1.5; display: flex; align-items: center; gap: 15px;">
                    <div class="filter-tabs">
                        <div class="filter-tab active" data-filter="active" onclick="setOrderFilter('active', this)">
                            الطلبات النشطة</div>
                        <div class="filter-tab" data-filter="archived" onclick="setOrderFilter('archived', this)">
                            الطلبات المؤرشفة</div>
                    </div>
                </div>

                <div id="orders-bulk-actions" class="bulk-actions">
                    <span class="selected-count"><span id="orders-selected-count">0</span> محدد</span>
                    <button class="btn btn-small btn-delete" onclick="bulkDelete('orders')">
                        <i class="fas fa-trash"></i> حذف المحدد
                    </button>
                    <button class="btn btn-small btn-secondary" onclick="bulkArchive('orders')">
                        <i class="fas fa-archive"></i> أرشفة المحدد
                    </button>
                </div>
            </div>

            <div class="card" style="margin-top: 1.5rem;">
                <div class="table-responsive">
                    <table>
                        <thead>
                            <tr>
                                <th style="width: 40px;"><input type="checkbox" id="select-all-orders"
                                        onchange="toggleSelectAll('orders')"></th>
                                <th>رقم الطلب</th>
                                <th>التاريخ</th>
                                <th>العميل</th>
                                <th>المبلغ</th>
                                <th>الحالة</th>
                                <th>الإجراء</th>
                            </tr>
                        </thead>
                        <tbody id="orders-table"></tbody>
                    </table>
                </div>
            </div>
        </div>


        <!-- Customers Section -->
        <div id="section-customers" class="content-section">
            <div class="page-header">
                <h1>إدارة العملاء</h1>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <div class="search-box" style="position: relative; max-width: 350px; flex: 1;">
                        <i class="fas fa-search"
                            style="position: absolute; right: 15px; top: 50%; transform: translateY(-50%); color: #95a5a6;"></i>
                        <input type="text" id="customer-search" placeholder="بحث بالاسم، البريد أو الهاتف..."
                            class="form-control" style="padding-right: 40px;" oninput="refreshCustomers()">
                    </div>
                    <button class="btn btn-success" onclick="openExportModal('customers')">
                        <i class="fas fa-file-excel"></i> استخراج البيانات
                    </button>
                    <button class="btn btn-primary" style="background-color: #25D366; border-color: #25D366;"
                        onclick="openBulkWhatsAppModal()">
                        <i class="fab fa-whatsapp"></i> رسالة جماعية للعملاء
                    </button>
                </div>
            </div>

            <div class="card">
                <div class="table-responsive">
                    <table>
                        <thead>
                            <tr>
                                <th>الاسم</th>
                                <th>البريد الإلكتروني</th>
                                <th>رقم الهاتف</th>
                                <th>تاريخ التسجيل</th>
                                <th>الإجراء</th>
                            </tr>
                        </thead>
                        <tbody id="customers-table"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- SEO Section -->
        <div id="section-seo" class="content-section">
            <div class="page-header">
                <h1><i class="fas fa-search" style="margin-left: 10px; color: var(--primary-color);"></i> تحسين محركات
                    البحث (SEO)
                </h1>
                <p class="text-muted">إدارة الكلمات المفتاحية، Meta Tags، وتحسين ظهور المتجر في نتائج البحث</p>
            </div>

            <!-- SEO Stats Cards -->
            <div class="stats-grid" style="margin-bottom: 2rem;">
                <div class="stat-card" style="border-right-color: var(--success-color);">
                    <div class="stat-content">
                        <div>
                            <h3>الكلمات المفتاحية</h3>
                            <p id="keywords-count">0</p>
                        </div>
                        <i class="fas fa-key icon-bg" style="color: var(--success-color);"></i>
                    </div>
                </div>
                <div class="stat-card" style="border-right-color: var(--danger-color);">
                    <div class="stat-content">
                        <div>
                            <h3>حالة Sitemap</h3>
                            <p class="stat-status text-success"><i class="fas fa-check-circle"></i> نشط</p>
                        </div>
                        <i class="fas fa-sitemap icon-bg" style="color: var(--danger-color);"></i>
                    </div>
                </div>
                <div class="stat-card" style="border-right-color: var(--warning-color);">
                    <div class="stat-content">
                        <div>
                            <h3>Google Verification</h3>
                            <p class="stat-status" id="google-verify-status">غير مفعّل</p>
                        </div>
                        <i class="fab fa-google icon-bg" style="color: var(--warning-color);"></i>
                    </div>
                </div>
            </div>

            <!-- Keywords Management -->
            <div class="card">
                <div class="card-header">
                    <h2 style="color: var(--success-color);"><i class="fas fa-key" style="margin-left: 8px;"></i> إدارة
                        الكلمات المفتاحية
                    </h2>
                    <button class="btn btn-primary" onclick="addKeyword()">
                        <i class="fas fa-plus"></i> إضافة كلمة مفتاحية
                    </button>
                </div>

                <div class="info-box">
                    <p>
                        <i class="fas fa-info-circle icon-info"></i>
                        <strong>نصيحة:</strong> استخدم كلمات مفتاحية متنوعة بالعربي والإنجليزي لتحسين ظهور متجرك في
                        نتائج البحث
                    </p>
                </div>

                <div id="keywords-container" class="keywords-grid">
                    <!-- Keywords will be injected here -->
                </div>

                <div class="suggestion-box">
                    <h4>
                        <i class="fas fa-lightbulb icon-warning"></i>
                        كلمات مفتاحية مقترحة
                    </h4>
                    <div class="keywords-list" id="suggested-keywords-container">
                        <!-- Suggested keywords will be injected here dynamically -->
                    </div>
                </div>
            </div>

            <!-- Meta Tags -->
            <div class="card">
                <div class="card-header">
                    <h2 style="color: #9b59b6;"><i class="fas fa-tags" style="margin-left: 8px;"></i> Meta Tags الرئيسية
                    </h2>
                    <button class="btn btn-primary" onclick="saveMetaTags()">
                        <i class="fas fa-save"></i> حفظ التغييرات
                    </button>
                </div>

                <div class="form-group">
                    <label><i class="fas fa-heading" style="margin-left: 5px;"></i> عنوان الموقع (Title)</label>
                    <input type="text" id="meta-title" class="form-control"
                        placeholder="متجر الشرقاوي | Elsharkawy Store" maxlength="60">
                    <small class="text-muted">
                        <span id="title-length">0</span>/60 حرف - يظهر في نتائج البحث
                    </small>
                </div>

                <div class="form-group">
                    <label><i class="fas fa-align-left" style="margin-left: 5px;"></i> وصف الموقع (Description)</label>
                    <textarea id="meta-description" class="form-control" rows="3"
                        placeholder="وجهتك الأولى لأحدث صيحات الأحذية والسنيكرز العصرية..." maxlength="160"></textarea>
                    <small class="text-muted">
                        <span id="desc-length">0</span>/160 حرف - يظهر أسفل العنوان في نتائج البحث
                    </small>
                </div>

                <div class="form-group">
                    <label><i class="fab fa-google" style="margin-left: 5px;"></i> Google Site Verification Code</label>
                    <input type="text" id="google-verify-code" class="form-control" placeholder="ABC123XYZ...">
                    <small class="text-muted">
                        احصل عليه من <a href="https://search.google.com/search-console" target="_blank"
                            class="link-primary">Google Search Console</a>
                    </small>
                </div>
            </div>

            <!-- Sitemap & Robots.txt -->
            <div class="card">
                <div class="card-header">
                    <h2 style="color: var(--warning-color);"><i class="fas fa-sitemap" style="margin-left: 8px;"></i>
                        Sitemap & Robots.txt
                    </h2>
                </div>

                <div class="grid-2-col">
                    <div class="info-card border-success">
                        <h4 class="text-dark">
                            <i class="fas fa-file-code text-success icon-margin"></i>
                            Sitemap.xml
                        </h4>
                        <p class="text-muted description">
                            خريطة الموقع تساعد محركات البحث على فهرسة صفحاتك
                        </p>
                        <div class="button-group">
                            <button class="btn btn-secondary" onclick="viewSitemap()">
                                <i class="fas fa-eye"></i> عرض
                            </button>
                            <button class="btn btn-primary" onclick="copySitemapLink()">
                                <i class="fas fa-copy"></i> نسخ الرابط
                            </button>
                        </div>
                    </div>

                    <div class="info-card border-primary">
                        <h4 class="text-dark">
                            <i class="fas fa-robot text-primary icon-margin"></i>
                            Robots.txt
                        </h4>
                        <p class="text-muted description">
                            يتحكم في الصفحات التي تزحف إليها محركات البحث
                        </p>
                        <div class="button-group">
                            <button class="btn btn-secondary" onclick="viewRobots()">
                                <i class="fas fa-eye"></i> عرض
                            </button>
                            <button class="btn btn-primary" onclick="copyRobotsLink()">
                                <i class="fas fa-copy"></i> نسخ الرابط
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions & Resources -->
            <div class="card">
                <div class="card-header">
                    <h2 style="color: #e74c3c;"><i class="fas fa-rocket" style="margin-left: 8px;"></i> إجراءات سريعة
                        ومصادر مفيدة</h2>
                </div>

                <div class="resources-grid">
                    <a href="https://search.google.com/search-console" target="_blank" class="seo-resource-card">
                        <div class="resource-content">
                            <div class="resource-icon icon-google">
                                <i class="fab fa-google"></i>
                            </div>
                            <div>
                                <h4>Google Search Console</h4>
                                <p>راقب أداء موقعك في Google</p>
                            </div>
                        </div>
                    </a>

                    <a href="https://www.bing.com/webmasters" target="_blank" class="seo-resource-card">
                        <div class="resource-content">
                            <div class="resource-icon icon-bing">
                                <i class="fab fa-microsoft"></i>
                            </div>
                            <div>
                                <h4>Bing Webmaster Tools</h4>
                                <p>سجل موقعك في Bing</p>
                            </div>
                        </div>
                    </a>

                    <a href="https://pagespeed.web.dev" target="_blank" class="seo-resource-card">
                        <div class="resource-content">
                            <div class="resource-icon icon-speed">
                                <i class="fas fa-tachometer-alt"></i>
                            </div>
                            <div>
                                <h4>PageSpeed Insights</h4>
                                <p>قياس سرعة الموقع</p>
                            </div>
                        </div>
                    </a>

                    <a href="https://trends.google.com" target="_blank" class="seo-resource-card">
                        <div class="resource-content">
                            <div class="resource-icon icon-trends">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div>
                                <h4>Google Trends</h4>
                                <p>اكتشف الكلمات الرائجة</p>
                            </div>
                        </div>
                    </a>
                </div>

                <div class="guide-box">
                    <h4 style="color: #856404;">
                        <i class="fas fa-book" style="margin-left: 5px;"></i>
                        أدلة SEO المتوفرة
                    </h4>
                    <p style="color: #856404;">
                        تم إنشاء أدلة شاملة لمساعدتك في تحسين ظهور متجرك في محركات البحث
                    </p>
                    <div class="button-group">
                        <button class="btn btn-secondary" onclick="openSEOGuide('SEO_README.md')">
                            <i class="fas fa-file-alt"></i> دليل البداية
                        </button>
                        <button class="btn btn-secondary" onclick="openSEOGuide('SEARCH_ENGINE_STEPS.md')">
                            <i class="fas fa-list-ol"></i> خطوات عملية
                        </button>
                        <button class="btn btn-secondary" onclick="openSEOGuide('KEYWORDS.md')">
                            <i class="fas fa-key"></i> الكلمات المفتاحية
                        </button>
                        <button class="btn btn-secondary" onclick="openSEOGuide('SEO_GUIDE.md')">
                            <i class="fas fa-book-open"></i> الدليل الشامل
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Site Settings Section -->
        <div id="section-settings" class="content-section">
            <div class="page-header">
                <h1>إعدادات الموقع</h1>
            </div>

            <div class="card">
                <form id="settings-form">
                    <div class="form-section">
                        <h3 class="section-title border-primary">
                            <i class="fas fa-home icon-primary"></i> إعدادات الواجهة (Hero Section)
                        </h3>
                    </div>
                    <div class="stats-grid">
                        <div class="form-group">
                            <label>عنوان الهيرو (عربي) - يدعم HTML</label>
                            <textarea id="s-heroTitleAr" rows="3" required class="form-control"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Hero Title (English)</label>
                            <textarea id="s-heroTitleEn" rows="3" required class="form-control"></textarea>
                        </div>
                        <div class="form-group">
                            <label>وصف الهيرو (عربي)</label>
                            <textarea id="s-heroDescAr" rows="3" required class="form-control"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Hero Description (English)</label>
                            <textarea id="s-heroDescEn" rows="3" required class="form-control"></textarea>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>رابط صورة الهيرو</label>
                        <input type="url" id="s-heroImage" required class="form-control">
                    </div>
                    <div class="form-group">
                        <label>اسم المتجر</label>
                        <input type="text" id="s-storeName" required class="form-control">
                    </div>
                    <div class="form-group">
                        <label>رقم الواتساب (بالصيغة الدولية: 201125655690)</label>
                        <input type="text" id="s-whatsapp" required class="form-control">
                    </div>

                    <div class="form-section mt-4">
                        <h3 class="section-title border-primary">
                            <i class="fas fa-bullhorn icon-primary"></i> شريط التنبيهات (Announcement Bar)
                        </h3>
                    </div>
                    <p class="text-muted">يظهر شريط في أعلى كل صفحات المتجر للإعلان عن عروض أو تنبيهات.</p>
                    <div class="form-group checkbox-group">
                        <input type="checkbox" id="s-announcementEnabled">
                        <label for="s-announcementEnabled">تفعيل شريط التنبيهات</label>
                    </div>
                    <div class="stats-grid">
                        <div class="form-group">
                            <label>نص التنبيه (عربي)</label>
                            <input type="text" id="s-announcementTextAr" class="form-control"
                                placeholder="مثال: خصم 50% بمناسبة الافتتاح!">
                        </div>
                        <div class="form-group">
                            <label>Announcement Text (English)</label>
                            <input type="text" id="s-announcementTextEn" class="form-control"
                                placeholder="Example: 50% Off Grand Opening!">
                        </div>
                    </div>

                    <div class="form-section mt-4">
                        <h3 class="section-title border-warning">
                            <i class="fas fa-tools icon-warning"></i> وضع الصيانة (Maintenance Mode)
                        </h3>
                    </div>
                    <p class="text-muted">تفعيل هذا الوضع سيغلق واجهة المتجر للعملاء ويظهر رسالة صيانة.</p>
                    <div class="form-group checkbox-group">
                        <input type="checkbox" id="s-maintenanceMode">
                        <label for="s-maintenanceMode" class="text-warning">تفعيل وضع الصيانة</label>
                    </div>
                    <div class="form-group">
                        <label>رسالة الصيانة (عربي)</label>
                        <input type="text" id="s-maintenanceMessageAr" class="form-control"
                            placeholder="مثال: الموقع تحت الصيانة حالياً، سنعود قريباً">
                    </div>
                    <div class="form-group">
                        <label>Maintenance Message (English)</label>
                        <input type="text" id="s-maintenanceMessageEn" class="form-control"
                            placeholder="Example: Site is under maintenance, back soon">
                    </div>

                    <div class="form-section mt-4">
                        <h3 class="section-title">
                            <i class="fas fa-percent icon-primary"></i> قسم العروض الترويجي (Offers Section)
                        </h3>
                    </div>
                    <p class="text-muted">التحكم في البانر الكبير الموجود في الصفحة الرئيسية.</p>
                    <div class="form-group checkbox-group">
                        <input type="checkbox" id="s-offerEnabled">
                        <label for="s-offerEnabled">عرض قسم العروض في الصفحة الرئيسية</label>
                    </div>
                    <div class="stats-grid">
                        <div class="form-group">
                            <label>عنوان العرض (عربي)</label>
                            <input type="text" id="s-offerTitle" class="form-control"
                                placeholder="مثال: تخفيضات نهاية العام">
                        </div>
                        <div class="form-group">
                            <label>وصف العرض (عربي)</label>
                            <input type="text" id="s-offerDesc" class="form-control"
                                placeholder="مثال: احصل على خصم يصل إلى 40% على منتجات مختارة.">
                        </div>
                        <div class="form-group">
                            <label>نص الزر (عربي)</label>
                            <input type="text" id="s-offerBtn" class="form-control" placeholder="مثال: عرض العروض">
                        </div>
                        <div class="form-group">
                            <label>رابط صفحة Instagram (اختياري)</label>
                            <input type="text" id="s-instagram" class="form-control" placeholder="username">
                        </div>
                    </div>

                    <div class="form-group mt-3">
                        <label>طريقة عرض عرض "البانر الكبير"</label>
                        <select id="s-offerMode" class="form-control" onchange="toggleOfferMode()">
                            <option value="link">رابط مخصص (Link)</option>
                            <option value="manual">يدوي (تحديد منتج معين)</option>
                        </select>
                    </div>

                    <div id="link-offer-selector" class="form-group">
                        <label>رابط الزر (مثال: products.html)</label>
                        <input type="text" id="s-offerLink" class="form-control" placeholder="products.html">
                    </div>

                    <div id="manual-offer-selector"
                        style="display: none; background: #f8f9fa; padding: 15px; border-radius: 8px; border: 1px solid #ddd;">
                        <label style="margin-bottom: 10px; display: block; font-weight: bold;">اختر المنتج الذي تود
                            عرضه:</label>
                        <div id="offer-products-list"
                            style="max-height: 200px; overflow-y: auto; display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px;">
                            <!-- Products injected via JS -->
                        </div>
                        <input type="hidden" id="s-offerProductId">
                    </div>

                    <div class="form-section">
                        <h3 class="section-title border-danger">
                            <i class="fas fa-hourglass-half icon-danger"></i> مؤقت العرض (Countdown Timer)
                        </h3>
                    </div>
                    <div class="stats-grid">
                        <div class="form-group">
                            <label>تفعيل المؤقت</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="s-timerEnabled">
                                <span class="slider round"></span>
                            </label>
                        </div>
                        <div class="form-group">
                            <label>مدة المؤقت (بالساعات)</label>
                            <input type="number" id="s-timerDuration" class="form-control" placeholder="10" min="1">
                        </div>
                        <div class="form-group">
                            <label>نص المؤقت (بالعربي)</label>
                            <input type="text" id="s-timerTextAr" class="form-control" placeholder="العرض ينتهي خلال:">
                        </div>
                    </div>

                    <div class="form-section mt-4">
                        <h3 class="section-title border-info">
                            <i class="fas fa-th-large icon-info"></i> مجموعات الصفحة الرئيسة (Homepage Groups)
                        </h3>
                    </div>
                    <p class="text-muted">تحكم في الصور والروابط للأقسام التي تظهر في الصفحة الرئيسية.</p>
                    <div class="form-group checkbox-group">
                        <input type="checkbox" id="s-showCollections">
                        <label for="s-showCollections">عرض قسم المجموعات في الصفحة الرئيسية</label>
                    </div>
                    <div id="home-categories-container">
                        <!-- Categories injected here -->
                    </div>
                    <button type="button" class="btn btn-secondary btn-small" onclick="addHomeCategoryField()">
                        <i class="fas fa-plus"></i> إضافة قسم جديد للمجموعات
                    </button>

                    <div class="form-section mt-4">
                        <h3 class="section-title border-success">
                            <i class="fas fa-star icon-success"></i> التحكم في منتجات "الأكثر رواجاً"
                        </h3>
                    </div>
                    <div class="form-group checkbox-group">
                        <input type="checkbox" id="s-showFeatured">
                        <label for="s-showFeatured">عرض قسم "المنتجات الأكثر رواجاً" في الصفحة الرئيسية</label>
                    </div>
                    <div class="stats-grid">
                        <div class="form-group">
                            <label>عنوان القسم (عربي)</label>
                            <input type="text" id="s-featuredTitleAr" required class="form-control">
                        </div>
                        <div class="form-group">
                            <label>عنوان القسم (English)</label>
                            <input type="text" id="s-featuredTitleEn" required class="form-control">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>طريقة عرض المنتجات المميزة</label>
                        <select id="s-featuredMode" class="form-control" onchange="toggleFeaturedMode()">
                            <option value="auto">تلقائي (أحدث المنتجات)</option>
                            <option value="manual">يدوي (تحديد منتجات معينة)</option>
                        </select>
                    </div>

                    <div id="manual-featured-selector"
                        style="display: none; background: #f8f9fa; padding: 15px; border-radius: 8px; border: 1px solid #ddd;">
                        <label style="margin-bottom: 10px; display: block; font-weight: bold;">اختر المنتجات التي تود
                            عرضها:</label>
                        <div id="featured-products-list"
                            style="max-height: 200px; overflow-y: auto; display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px;">
                            <!-- Products injected via JS -->
                        </div>
                        <input type="hidden" id="s-featuredProductIds">
                    </div>

                    <div class="form-group">
                        <label>Facebook Pixel ID</label>
                        <input type="text" id="s-fbPixelId" class="form-control" placeholder="مثال: 123456789012345">
                        <p class="text-muted small">سيتم تفعيل البيكسل تلقائياً في جميع الصفحات عند إدخال المعرف هنا.
                        </p>
                    </div>

                    <div class="form-section mt-4">
                        <h3 class="section-title border-info">
                            <i class="fas fa-sitemap icon-info"></i> خرائط الموقع والأرشفة (SEO)
                        </h3>
                    </div>
                    <p class="text-muted">استخدم هذه الروابط لإضافة متجرك في Google Search Console لتسريع أرشفة
                        المنتجات.</p>

                    <div class="form-group-box">
                        <label>رابط ملف الـ Sitemap:</label>
                        <div class="toolbar-actions" style="justify-content: flex-start; margin-top: 10px;">
                            <input type="text" id="sitemap-url" readonly class="form-control"
                                style="direction: ltr; flex: 1;">
                            <button type="button" class="btn btn-primary" onclick="copySitemapLink()">
                                <i class="fas fa-copy"></i> نسخ الرابط
                            </button>
                        </div>
                        <p class="text-success small" style="margin-top: 8px;">
                            <i class="fas fa-info-circle"></i> قم بنسخ هذا الرابط ووضعه في Google Search Console تحت قسم
                            Sitemaps.
                        </p>
                    </div>

                    <div class="form-group">
                        <label>كود التحقق من Google (Google-Site-Verification)</label>
                        <input type="text" id="s-googleVerify" class="form-control"
                            placeholder="مثال: dXdf... (اختياري)">
                        <p class="text-muted small">إذا كنت ترغب في التحقق من الملكية عبر Meta Tag، ضع الكود هنا.</p>
                    </div>

                    <div class="form-section mt-4">
                        <h3 class="section-title border-danger">
                            <i class="fas fa-shopping-cart icon-danger"></i> رسائل السلة المتروكة (Abandoned Cart)
                        </h3>
                    </div>
                    <div class="form-group">
                        <label>نص الرسالة التذكيرية على واتساب</label>
                        <textarea id="s-abandonedMsg" rows="3" class="form-control"
                            placeholder="استخدم {name} للاسم و {total} للمبلغ"></textarea>
                    </div>

                    <div class="form-section mt-4">
                        <h3 class="section-title border-warning">
                            <i class="fas fa-comments icon-warning"></i> آراء العملاء (Customer Reviews)
                        </h3>
                    </div>
                    <div class="form-group checkbox-group">
                        <input type="checkbox" id="s-reviewsEnabled">
                        <label for="s-reviewsEnabled">عرض قسم آراء العملاء في الصفحة الرئيسية</label>
                    </div>
                    <div class="form-group checkbox-group">
                        <input type="checkbox" id="s-allowCustomerReviews">
                        <label for="s-allowCustomerReviews">السماح للعملاء بكتابة تقييم بعد الشراء</label>
                    </div>
                    <div id="reviews-container">
                        <!-- Dynamic Reviews -->
                    </div>
                    <button type="button" class="btn btn-secondary" onclick="addReviewField()"
                        style="margin-bottom: 2rem;">
                        + إضافة رأي عميل جديد
                    </button>



                    <div class="form-section mt-4">
                        <h3 class="section-title border-primary">
                            <i class="fas fa-file-contract icon-primary"></i> سياسات المتجر (Store Policies)
                        </h3>
                    </div>
                    <p class="text-muted">أدخل نصوص السياسات التي ستظهر للعملاء في أسفل الموقع.</p>

                    <div class="stats-grid">
                        <div class="form-group" style="grid-column: span 3;">
                            <label>الشروط والأحكام</label>
                            <div id="s-terms-editor" style="height: 200px; background: white;"></div>
                        </div>
                        <div class="form-group" style="grid-column: span 3;">
                            <label>سياسة الشحن والتوصيل</label>
                            <div id="s-shipping-editor" style="height: 200px; background: white;"></div>
                        </div>
                        <div class="form-group" style="grid-column: span 3;">
                            <label>سياسة الاسترجاع والاستبدال</label>
                            <div id="s-refund-editor" style="height: 200px; background: white;"></div>
                        </div>
                        <div class="form-group" style="grid-column: span 3;">
                            <label>سياسة الخصوصية</label>
                            <div id="s-privacy-editor" style="height: 200px; background: white;"></div>
                        </div>
                    </div>

                    <div class="info-card border-primary">
                        <h4 class="text-dark">
                            <i class="fas fa-user-shield icon-primary"></i> بيانات تسجيل دخول الأدمن
                        </h4>
                        <div class="stats-grid">
                            <div class="form-group">
                                <label>البريد الإلكتروني الحالي</label>
                                <input type="email" id="s-adminEmail" readonly class="form-control"
                                    style="background: #eee;">
                            </div>
                            <div class="form-group">
                                <label>البريد الإلكتروني الجديد (اختياري)</label>
                                <input type="email" id="s-newAdminEmail" class="form-control"
                                    placeholder="اتركه فارغاً للحفاظ على الحالي">
                            </div>
                            <div class="form-group">
                                <label>كلمة المرور الجديدة</label>
                                <input type="password" id="s-newAdminPass" class="form-control"
                                    placeholder="كلمة مرور قوية">
                            </div>
                            <div class="form-group">
                                <label>تأكيد كلمة المرور</label>
                                <input type="password" id="s-confirmAdminPass" class="form-control"
                                    placeholder="أعد كتابة كلمة المرور">
                            </div>
                        </div>
                    </div>

                    <!-- Bosta Shipping Integration -->
                    <div class="form-section mt-4">
                        <h3 class="section-title border-info">
                            <i class="fas fa-shipping-fast icon-info"></i> تكامل بوسطة للشحن (Bosta Shipping)
                        </h3>
                    </div>
                    <p class="text-muted">هذه هي بيانات **متجرك الشخصي** (المكان الذي سيأتي إليه مندوب بوسطة لاستلام
                        الشحنات منك). أما بيانات العميل فيتم سحبها تلقائياً من الطلب.</p>

                    <div class="info-card border-info">
                        <div class="form-group checkbox-group"
                            style="margin-bottom: 20px; background: rgba(52, 152, 219, 0.05); padding: 15px; border-radius: 10px;">
                            <input type="checkbox" id="s-bostaEnabled">
                            <label for="s-bostaEnabled" style="font-weight: bold; color: var(--info-color);">تفعيل الشحن
                                التلقائي فور التأكيد</label>
                        </div>

                        <div class="stats-grid">
                            <div class="form-group" style="grid-column: span 3;">
                                <label>Bosta API Key <span class="text-danger">*</span></label>
                                <input type="text" id="s-bostaApiKey" class="form-control"
                                    placeholder="أدخل الـ API Key الخاص بك هنا" style="direction: ltr;">
                                <p class="text-muted small">
                                    <i class="fas fa-info-circle"></i> يمكنك الحصول على API Key من لوحة تحكم بوسطة:
                                    <a href="https://business.bosta.co/settings/api" target="_blank">Settings > API
                                        Keys</a>
                                </p>
                            </div>
                        </div>

                        <div class="stats-grid" style="margin-top: 10px;">
                            <div class="form-group" style="grid-column: span 3;">
                                <label style="display: flex; justify-content: space-between;">
                                    رابط الـ Webhook (لتلقي التحديثات تلقائياً)
                                    <span class="badge badge-success" style="cursor: pointer;"
                                        onclick="copyWebhookUrl()">
                                        <i class="fas fa-copy"></i> نسخ الرابط
                                    </span>
                                </label>
                                <input type="text" id="s-bostaWebhookUrl" class="form-control" readonly
                                    style="background: #f8f9fa; direction: ltr; font-family: monospace; font-size: 0.9rem;">
                                <div class="alert alert-info"
                                    style="margin-top: 10px; padding: 10px; font-size: 0.85rem;">
                                    <i class="fas fa-lightbulb"></i> <strong>كيف تفعلها؟</strong>
                                    قم بنسخ هذا الرابط ووضعه في لوحة تحكم بوسطة بمجرد الضغط على "Add Webhook" واختيار
                                    نوع الأحداث (Delivery Status Updates).
                                </div>
                            </div>
                        </div>

                        <div class="stats-grid">
                            <div class="form-group">
                                <label>اسم النشاط التجاري</label>
                                <input type="text" id="s-bostaBusinessName" class="form-control"
                                    placeholder="مثلاً: رويعي الشرقاوي">
                            </div>
                            <div class="form-group">
                                <label>رقم هاتف المتجر</label>
                                <input type="text" id="s-bostaBusinessPhone" class="form-control"
                                    placeholder="الرقم اللي المندوب هيكلمك عليه">
                            </div>
                            <div class="form-group">
                                <label>المدينة (موقع مخزنك)</label>
                                <select id="s-bostaCity" class="form-control">
                                    <option value="">اختر المدينة</option>
                                    <option value="القاهرة">القاهرة</option>
                                    <option value="الجيزة">الجيزة</option>
                                    <option value="الإسكندرية">الإسكندرية</option>
                                    <option value="الدقهلية">الدقهلية</option>
                                    <option value="الشرقية">الشرقية</option>
                                    <option value="القليوبية">القليوبية</option>
                                    <option value="الغربية">الغربية</option>
                                    <option value="المنوفية">المنوفية</option>
                                    <option value="البحيرة">البحيرة</option>
                                    <option value="الإسماعيلية">الإسماعيلية</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>عنوان المتجر التفصيلي (Pickup Address)</label>
                            <input type="text" id="s-bostaAddress" class="form-control"
                                placeholder="الشارع والمنطقة والمحل / المخزن">
                        </div>

                        <div class="stats-grid" style="grid-template-columns: repeat(3, 1fr);">
                            <div class="form-group">
                                <label>رقم العقار</label>
                                <input type="text" id="s-bostaBuilding" class="form-control" placeholder="5">
                            </div>
                            <div class="form-group">
                                <label>الدور</label>
                                <input type="text" id="s-bostaFloor" class="form-control" placeholder="3">
                            </div>
                            <div class="form-group">
                                <label>رقم المكتب/الشقة</label>
                                <input type="text" id="s-bostaApartment" class="form-control" placeholder="10">
                            </div>
                        </div>

                        <div class="mt-3">
                            <button type="button" class="btn btn-secondary" onclick="testBostaConnection()">
                                <i class="fas fa-plug"></i> اختبار الاتصال
                            </button>
                            <span id="bosta-connection-status" class="mr-3"></span>
                        </div>
                    </div>



                    <div class="mt-4 pt-4 border-top">
                        <button type="submit" class="btn btn-primary btn-block p-3 text-lg">
                            <i class="fas fa-save"></i> حفظ كل الإعدادات
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- App Security Section -->
        <div id="section-app-security" class="content-section">
            <div class="page-header">
                <div>
                    <h1>أمان التطبيق (Mobile App Security)</h1>
                    <p class="text-muted">تحكم في قفل التطبيق ووسائل الحماية من هنا</p>
                </div>
            </div>

            <div class="card" style="max-width: 600px; margin: 0 auto;">
                <div class="info-card border-warning">
                    <h2 style="margin-bottom: 20px; color: var(--warning-color);">
                        <i class="fas fa-lock"></i> إعدادات القفل
                    </h2>

                    <!-- Toggle Security -->
                    <div class="form-group"
                        style="background: white; padding: 20px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
                        <label class="d-flex align-items-center" style="cursor: pointer; gap: 15px;">
                            <input type="checkbox" id="app-sec-enabled" style="width: 25px; height: 25px;">
                            <div style="flex: 1;">
                                <span style="font-weight: 900; font-size: 1.2rem; display: block;">تفعيل قفل
                                    التطبيق</span>
                                <small class="text-muted">عند التفعيل، سيُطلب منك رمز PIN في كل مرة تفتح فيها
                                    التطبيق.</small>
                            </div>
                        </label>
                    </div>

                    <!-- Change PIN -->
                    <div id="pin-settings-area">
                        <div class="form-group">
                            <label><i class="fas fa-key"></i> رمز PIN الجديد (4 أرقام)</label>
                            <input type="number" id="app-sec-pin" class="form-control" placeholder="****"
                                style="text-align: center; font-size: 2rem; letter-spacing: 15px; max-width: 250px; margin: 10px 0;"
                                oninput="if(this.value.length>4) this.value=this.value.slice(0,4)">
                        </div>

                        <!-- Biometrics -->
                        <div class="form-group"
                            style="background: white; padding: 15px; border-radius: 12px; border: 1px solid #eee;">
                            <label class="d-flex align-items-center" style="cursor: pointer; gap: 15px;">
                                <input type="checkbox" id="app-sec-bio" style="width: 20px; height: 20px;">
                                <span>تفعيل البصمة / FaceID</span>
                            </label>
                        </div>
                    </div>

                    <div style="margin-top: 30px;">
                        <button class="btn btn-primary btn-block p-3" onclick="saveAppSecuritySettings()">
                            <i class="fas fa-save"></i> حفظ إعدادات الأمان
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Statistics Section -->
        <div id="section-stats" class="content-section">
            <div class="page-header">
                <div>
                    <h1>إحصائيات وتحليلات الموقع</h1>
                    <p class="text-muted">متابعة أداء المتجر والزيارات</p>
                </div>
            </div>

            <div class="stats-filter-bar">
                <div class="date-inputs">
                    <div class="form-group-sm" style="flex: 1;">
                        <label style="font-size: 0.8rem; margin-bottom: 4px; display: block;">من:</label>
                        <input type="date" id="stats-start-date" class="form-control">
                    </div>
                    <span style="margin-top: 20px;">إلى</span>
                    <div class="form-group-sm" style="flex: 1;">
                        <label style="font-size: 0.8rem; margin-bottom: 4px; display: block;">إلى:</label>
                        <input type="date" id="stats-end-date" class="form-control">
                    </div>
                    <button class="btn btn-primary" onclick="refreshStats()" style="margin-top: 20px;">
                        <i class="fas fa-sync-alt"></i> <span class="hide-mobile">تحديث</span>
                    </button>
                </div>
                <div class="compare-toggle">
                    <label class="checkbox-label" style="background: #f8f9fa; border: 1px solid #eee;">
                        <input type="checkbox" id="stats-compare" onchange="refreshStats()">
                        <span>مقارنة سابقة</span>
                    </label>
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card success" style="border-right-color: #27ae60;">
                    <div class="stat-icon-box"><i class="fas fa-users"></i></div>
                    <h3>المستخدمين الآن</h3>
                    <p id="live-users" class="text-success">--</p>
                    <small>نشطون في آخر 5 دقائق</small>
                </div>
                <div class="stat-card warning" style="border-right-color: #f39c12;">
                    <div class="stat-icon-box"><i class="fas fa-clock"></i></div>
                    <h3>متوسط وقت التصفح</h3>
                    <p id="avg-time">--</p>
                    <small>دقيقة / جلسة</small>
                </div>
                <div class="stat-card danger" style="border-right-color: #e74c3c;">
                    <div class="stat-icon-box"><i class="fas fa-door-open"></i></div>
                    <h3>معدل الارتداد</h3>
                    <p id="bounce-rate">--</p>
                    <small>% من الزيارات</small>
                </div>
                <div class="stat-card info" style="border-right-color: #3498db;">
                    <div class="stat-icon-box"><i class="fas fa-eye"></i></div>
                    <h3>إجمالي الزيارات</h3>
                    <p id="total-visits">--</p>
                    <small>زيارة خلال هذا الشهر</small>
                </div>
            </div>

            <div class="grid-2-col-wide">
                <div class="card">
                    <div class="card-header">
                        <h2><i class="fas fa-chart-line icon-primary icon-margin"></i> رسم بياني للمبيعات</h2>
                    </div>
                    <div class="chart-container">
                        <canvas id="salesChart"></canvas>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h2><i class="fas fa-chart-pie icon-success icon-margin"></i> توزيع الأقسام</h2>
                    </div>
                    <div class="chart-container" style="display: flex; justify-content: center; align-items: center;">
                        <canvas id="categoryChart" style="max-height: 250px;"></canvas>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <h2><i class="fas fa-network-wired icon-info icon-margin"></i> مصادر الزيارات</h2>
                        </div>
                        <div class="traffic-sources-list" id="traffic-sources-list" style="padding: 20px;">
                            <p class="text-muted" style="text-align: center;">جاري تحميل البيانات...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Abandoned Carts Section -->

        <div id="section-abandoned" class="content-section">
            <div class="page-header">
                <h1>السلّات المتروكة (Abandoned Carts)</h1>
            </div>

            <div class="card">
                <div class="table-responsive">
                    <table>
                        <thead>
                            <tr>
                                <th>التاريخ</th>
                                <th>العميل</th>
                                <th>المنتجات</th>
                                <th>الإجمالي</th>
                                <th>الإجراءات</th>
                            </tr>
                        </thead>
                        <tbody id="abandoned-table"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Discounts Section -->
        <div id="section-discounts" class="content-section">
            <div class="page-header">
                <h1>إدارة الخصومات والعروض</h1>
            </div>

            <div style="display: flex; flex-direction: column; gap: 20px;">
                <!-- Coupon Codes -->
                <div class="card h-fit">
                    <div class="card-header" style="flex-wrap: wrap; gap: 10px;">
                        <h2 style="font-size: 1.1rem;"><i class="fas fa-ticket-alt"
                                style="margin-left: 8px;"></i>كوبونات الخصم</h2>
                        <button class="btn btn-primary btn-small" onclick="openCouponModal()">
                            <i class="fas fa-plus"></i> إضافة كوبون
                        </button>
                    </div>
                    <div class="table-responsive table-compact">
                        <table>
                            <thead>
                                <tr>
                                    <th>الكود</th>
                                    <th>الخصم</th>
                                    <th>التاريخ</th>
                                    <th>حذف</th>
                                </tr>
                            </thead>
                            <tbody id="coupons-table"></tbody>
                        </table>
                    </div>
                </div>

                <!-- Special Offers -->
                <div class="card h-fit">
                    <div class="card-header">
                        <h2 style="font-size: 1.1rem;"><i class="fas fa-gift" style="margin-left: 8px;"></i>العروض
                            الخاصة</h2>
                    </div>
                    <form id="special-offers-form">
                        <div class="form-section">
                            <h3 class="section-title border-warning" style="font-size: 1rem;">
                                <i class="fas fa-tags icon-warning"></i> تخفيض شامل للمتجر
                            </h3>

                            <div class="form-group checkbox-group">
                                <input type="checkbox" id="off-global-enabled">
                                <label for="off-global-enabled" style="font-size: 0.9rem;">تفعيل التخفيض الشامل</label>
                            </div>

                            <div class="form-group">
                                <label style="font-size: 0.85rem;">نسبة الخصم (%)</label>
                                <input type="number" id="off-global-discount" placeholder="مثال: 10" min="0" max="100"
                                    class="form-control">
                            </div>

                            <div class="form-group">
                                <label style="font-size: 0.85rem;">نص الشارة (Badge Text)</label>
                                <input type="text" id="off-global-text" placeholder="مثال: خصم نهاية العام"
                                    class="form-control">
                                <small class="text-muted" style="font-size: 0.7rem;">يظهر هذا النص بجانب المنتجات في
                                    الصفحة الرئيسية</small>
                            </div>
                        </div>

                        <div class="form-section" style="margin-top: 15px;">
                            <h3 class="section-title border-primary" style="font-size: 1rem;">
                                <i class="fas fa-truck icon-primary"></i> الشحن المجاني
                            </h3>
                            <div class="form-group">
                                <label style="font-size: 0.85rem;">الحد الأدنى للطلب (ج.م)</label>
                                <input type="number" id="off-shipping-threshold" placeholder="مثال: 1000"
                                    class="form-control">
                                <small class="text-muted" style="font-size: 0.7rem;">اتركه فارغاً لإلغاء عرض الشحن
                                    المجاني</small>
                            </div>
                        </div>

                        <button type="submit" class="btn btn-primary btn-block"
                            style="padding: 12px; font-size: 0.95rem;">
                            <i class="fas fa-save" style="margin-left: 8px;"></i> حفظ جميع العروض
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Shipping Section -->
        <div id="section-shipping" class="content-section">
            <div class="page-header">
                <h1>إعدادات الشحن</h1>
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-primary" onclick="openShippingModal()">+ إضافة منطقة جديدة</button>
                </div>
            </div>

            <div class="card">
                <div class="table-responsive">
                    <table>
                        <thead>
                            <tr>
                                <th>المحافظة / المنطقة</th>
                                <th>أسعار الشحن (وزن)</th>
                                <th>العمليات</th>
                            </tr>
                        </thead>
                        <tbody id="shipping-table"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Moderation Section -->
        <div id="section-moderation" class="content-section">
            <div class="page-header">
                <h1>مراجعة تقييمات العملاء</h1>
                <p class="text-muted">التقييمات التي تم إرسالها من قبل العملاء بعد الشراء (في انتظار الموافقة)</p>
            </div>

            <div class="card">
                <div class="table-responsive">
                    <table>
                        <thead>
                            <tr>
                                <th>التاريخ</th>
                                <th>العميل</th>
                                <th>التقييم</th>
                                <th>التعليق</th>
                                <th>الإجراءات</th>
                            </tr>
                        </thead>
                        <tbody id="moderation-table"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Staff Section -->
        <div id="section-staff" class="content-section">
            <div class="page-header">
                <h1>إدارة الموظفين والصلاحيات</h1>
                <button class="btn btn-primary" onclick="openStaffModal()">+ إضافة موظف جديد</button>
            </div>

            <div class="card">
                <div class="table-responsive">
                    <table>
                        <thead>
                            <tr>
                                <th>الموظف</th>
                                <th>البريد الإلكتروني</th>
                                <th>الصلاحيات</th>
                                <th>الإجراءات</th>
                            </tr>
                        </thead>
                        <tbody id="staff-table"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>

    <!-- Staff Modal -->
    <div id="staff-modal" class="modal">
        <div class="modal-content">
            <h3>بيانات الموظف</h3>
            <form id="staff-form">
                <input type="hidden" id="st-id">
                <div class="form-group">
                    <label>الاسم الكامل</label>
                    <input type="text" id="st-name" required class="form-control">
                </div>
                <div class="form-group">
                    <label>البريد الإلكتروني</label>
                    <input type="email" id="st-email" required class="form-control">
                </div>
                <div class="form-group">
                    <label>كلمة المرور</label>
                    <input type="password" id="st-pass" required class="form-control">
                </div>
                <div class="form-group">
                    <label>رمز PIN للقفل (اختياري - 4 أرقام)</label>
                    <input type="text" id="st-pin" maxlength="4" placeholder="مثلاً: 1234" class="form-control">
                </div>
                <style>
                    .permissions-grid {
                        display: grid;
                        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
                        gap: 12px;
                        margin-top: 15px;
                        background: #fcfcfc;
                        padding: 15px;
                        border-radius: 12px;
                        border: 1px solid #eee;
                    }

                    .perm-item {
                        display: flex;
                        align-items: center;
                        gap: 10px;
                        background: white;
                        padding: 10px;
                        border-radius: 8px;
                        border: 1px solid #f0f0f0;
                        cursor: pointer;
                        transition: all 0.2s;
                    }

                    .perm-item:hover {
                        border-color: var(--primary-color);
                        background: #f8fbff;
                    }

                    .perm-item input {
                        width: 18px;
                        height: 18px;
                        cursor: pointer;
                    }

                    .perm-label {
                        font-size: 0.9rem;
                        font-weight: 700;
                        color: var(--secondary-color);
                    }

                    .perm-icon {
                        width: 30px;
                        height: 30px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        border-radius: 6px;
                        font-size: 0.9rem;
                    }

                    .bg-products {
                        background: rgba(52, 152, 219, 0.1);
                        color: #3498db;
                    }

                    .bg-orders {
                        background: rgba(230, 126, 34, 0.1);
                        color: #e67e22;
                    }

                    .bg-customers {
                        background: rgba(46, 204, 113, 0.1);
                        color: #27ae60;
                    }

                    .bg-discounts {
                        background: rgba(155, 89, 182, 0.1);
                        color: #9b59b6;
                    }

                    .bg-stats {
                        background: rgba(52, 73, 94, 0.1);
                        color: #2c3e50;
                    }

                    .bg-settings {
                        background: rgba(149, 165, 166, 0.1);
                        color: #7f8c8d;
                    }

                    .bg-moderation {
                        background: rgba(231, 76, 60, 0.1);
                        color: #e74c3c;
                    }

                    .bg-seo {
                        background: rgba(43, 203, 186, 0.1);
                        color: #2bcbba;
                    }

                    .bg-dashboard {
                        background: rgba(69, 170, 242, 0.1);
                        color: #45aaf2;
                    }

                    .bg-shipping {
                        background: rgba(253, 150, 68, 0.1);
                        color: #fd9644;
                    }

                    .bg-abandoned {
                        background: rgba(136, 84, 208, 0.1);
                        color: #8854d0;
                    }
                </style>
                <label style="font-weight: 800; display: block; margin-top: 1rem;"><i class="fas fa-shield-alt"
                        style="margin-left: 5px;"></i> تحديد الصلاحيات</label>
                <div class="permissions-grid">
                    <label class="perm-item">
                        <input type="checkbox" value="dashboard">
                        <div class="perm-icon bg-dashboard"><i class="fas fa-home"></i></div>
                        <span class="perm-label">الرئيسية</span>
                    </label>
                    <label class="perm-item">
                        <input type="checkbox" value="products">
                        <div class="perm-icon bg-products"><i class="fas fa-box"></i></div>
                        <span class="perm-label">المنتجات</span>
                    </label>
                    <label class="perm-item">
                        <input type="checkbox" value="orders">
                        <div class="perm-icon bg-orders"><i class="fas fa-shopping-cart"></i></div>
                        <span class="perm-label">الطلبات</span>
                    </label>
                    <label class="perm-item">
                        <input type="checkbox" value="customers">
                        <div class="perm-icon bg-customers"><i class="fas fa-users"></i></div>
                        <span class="perm-label">العملاء</span>
                    </label>
                    <label class="perm-item">
                        <input type="checkbox" value="discounts">
                        <div class="perm-icon bg-discounts"><i class="fas fa-ticket-alt"></i></div>
                        <span class="perm-label">الخصومات</span>
                    </label>
                    <label class="perm-item">
                        <input type="checkbox" value="stats">
                        <div class="perm-icon bg-stats"><i class="fas fa-chart-line"></i></div>
                        <span class="perm-label">الإحصائيات</span>
                    </label>
                    <label class="perm-item">
                        <input type="checkbox" value="settings">
                        <div class="perm-icon bg-settings"><i class="fas fa-cog"></i></div>
                        <span class="perm-label">الإعدادات</span>
                    </label>

                    <label class="perm-item">
                        <input type="checkbox" value="seo">
                        <div class="perm-icon bg-seo"><i class="fas fa-search"></i></div>
                        <span class="perm-label">تحسين SEO</span>
                    </label>
                    <label class="perm-item">
                        <input type="checkbox" value="shipping">
                        <div class="perm-icon bg-shipping"><i class="fas fa-truck"></i></div>
                        <span class="perm-label">الشحن</span>
                    </label>
                    <label class="perm-item">
                        <input type="checkbox" value="abandoned">
                        <div class="perm-icon bg-abandoned"><i class="fas fa-shopping-basket"></i></div>
                        <span class="perm-label">السلّات المتروكة</span>
                    </label>
                    <label class="perm-item">
                        <input type="checkbox" value="moderation">
                        <div class="perm-icon bg-moderation"><i class="fas fa-comment-dots"></i></div>
                        <span class="perm-label">المراجعات</span>
                    </label>
                </div>
                <div class="modal-actions">
                    <button type="submit" class="btn btn-primary">حفظ</button>
                    <button type="button" class="btn btn-secondary" onclick="closeStaffModal()">إلغاء</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Custom Export Modal (Field Selection) -->
    <div id="export-modal" class="modal">
        <div class="modal-content" style="max-width: 550px; text-align: right; direction: rtl;">
            <div style="text-align: center; margin-bottom: 30px;">
                <div
                    style="width: 75px; height: 75px; background: #eafaf1; color: #2ecc71; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px auto; font-size: 2rem;">
                    <i class="fas fa-file-excel"></i>
                </div>
                <h2 id="export-modal-title" style="margin-bottom: 8px;">تخصيص تصدير البيانات</h2>
                <p class="text-muted">اختر البيانات التي تود إظهارها في ملف Excel</p>
            </div>

            <div id="export-fields-container"
                style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 30px;">
                <!-- Fields are injected dynamically -->
            </div>

            <div class="modal-actions"
                style="display: flex; gap: 12px; margin-top: 20px; border-top: 1px solid #eee; padding-top: 20px;">
                <button class="btn btn-primary" onclick="confirmExport()"
                    style="flex: 2; height: 50px; font-size: 1rem; border-radius: 12px; background: #2ecc71; border: none; font-weight: bold; color: white;">
                    <i class="fas fa-check-circle"></i> بدء التصدير (Excel)
                </button>
                <button class="btn btn-secondary" onclick="closeExportModal()"
                    style="flex: 1; height: 50px; border-radius: 12px; font-weight: bold;">إلغاء</button>
            </div>
        </div>
    </div>

    <!-- Coupon Modal -->
    <div id="coupon-modal" class="modal">
        <div class="modal-content">
            <h3>إضافة كوبون خصم</h3>
            <form id="coupon-form">
                <div class="form-group">
                    <label>كود الخصم</label>
                    <input type="text" id="c-code" required placeholder="مثال: SAVE20" class="form-control">
                </div>
                <div class="form-group">
                    <label>القيمة (%)</label>
                    <input type="number" id="c-pct" required min="1" max="100" class="form-control">
                </div>
                <div class="form-group">
                    <label>تاريخ الانتهاء (اختياري)</label>
                    <input type="date" id="c-expiry" class="form-control">
                </div>
                <div class="modal-actions">
                    <button type="submit" class="btn btn-primary">حفظ</button>
                    <button type="button" class="btn btn-secondary" onclick="closeCouponModal()">إلغاء</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Category Modal -->
    <div id="category-modal" class="modal">
        <div class="modal-content" style="max-width: 450px;">
            <div style="text-align: center; margin-bottom: 20px;">
                <div
                    style="width: 60px; height: 60px; background: rgba(155, 89, 182, 0.1); color: #9b59b6; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px auto; font-size: 1.5rem;">
                    <i class="fas fa-layer-group"></i>
                </div>
                <h3>إضافة مجموعة جديدة</h3>
                <p class="text-muted">أدخل اسم المجموعة التي تود إضافتها للمتجر</p>
            </div>
            <form id="category-form" onsubmit="handleCategorySubmit(event)">
                <div class="form-group">
                    <label>اسم المجموعة</label>
                    <input type="text" id="new-cat-name" required placeholder="مثال: إكسسوارات حمام"
                        class="form-control" autofocus>
                </div>
                <div class="modal-actions" style="margin-top: 25px;">
                    <button type="submit" class="btn btn-primary"
                        style="background: #9b59b6; border: none; flex: 2;">حفظ المجموعة</button>
                    <button type="button" class="btn btn-secondary" onclick="closeCategoryModal()"
                        style="flex: 1;">إلغاء</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Product Modal -->
    <div id="product-modal" class="modal">
        <div class="modal-content">
            <h3 style="margin-bottom: 2rem;">إضافة منتج جديد</h3>
            <form id="product-form">
                <div class="form-group checkbox-group"
                    style="background: #f8f9fa; padding: 10px; border-radius: 8px; margin-bottom: 15px; border-right: 4px solid var(--primary-color);">
                    <input type="checkbox" id="p-visible" checked>
                    <label for="p-visible" style="font-weight: bold; color: var(--secondary-color);">عرض المنتج في
                        المتجر
                        (نشط)</label>
                </div>
                <div class="form-group">
                    <label>اسم المنتج</label>
                    <input type="text" id="p-name" required class="form-control">
                </div>
                <div class="stats-grid"
                    style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 10px;">
                    <div class="form-group">
                        <label>السعر بعد الخصم (ج.م)</label>
                        <input type="number" id="p-price" required class="form-control">
                    </div>
                    <div class="form-group">
                        <label>السعر قبل الخصم (اختياري)</label>
                        <input type="number" id="p-old-price" placeholder="مثال: 1200" class="form-control">
                    </div>
                </div>

                <div class="stats-grid"
                    style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 10px;">
                    <div class="form-group">
                        <label>الكمية المتوفرة</label>
                        <input type="number" id="p-qty" placeholder="مثال: 50" class="form-control">
                    </div>
                    <div class="form-group">
                        <label>كود المنتج (SKU)</label>
                        <div style="position: relative;">
                            <input type="text" id="p-sku" placeholder="مثال: SKU-001" class="form-control"
                                style="background: #f8f9fa; padding-left: 40px;">
                            <button type="button"
                                onclick="copyToClipboard(document.getElementById('p-sku').value, this)"
                                style="position: absolute; left: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; color: #7f8c8d; cursor: pointer; transition: color 0.2s;"
                                onmouseover="this.style.color='var(--primary-color)'"
                                onmouseout="this.style.color='#7f8c8d'" title="نسخ الكود">
                                <i class="far fa-copy"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="stats-grid"
                    style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 15px; background: #f1f5f9; padding: 10px; border-radius: 10px;">
                    <div class="form-group" style="margin-bottom: 0;">
                        <label style="font-size: 0.8rem; font-weight: 800; color: #486b65;">الطول (سم)</label>
                        <input type="number" id="p-length" placeholder="0" class="form-control" step="0.1">
                    </div>
                    <div class="form-group" style="margin-bottom: 0;">
                        <label style="font-size: 0.8rem; font-weight: 800; color: #486b65;">العرض (سم)</label>
                        <input type="number" id="p-width" placeholder="0" class="form-control" step="0.1">
                    </div>
                    <div class="form-group" style="margin-bottom: 0;">
                        <label style="font-size: 0.8rem; font-weight: 800; color: #486b65;">الارتفاع (سم)</label>
                        <input type="number" id="p-height" placeholder="0" class="form-control" step="0.1">
                    </div>
                    <div class="form-group" style="margin-bottom: 0;">
                        <label style="font-size: 0.8rem; font-weight: 800; color: #e67e22;">الوزن (كجم)</label>
                        <input type="number" id="p-weight" placeholder="0.5" class="form-control" step="0.01">
                    </div>
                </div>



                <div class="form-group">
                    <label>المجموعة الأساسية</label>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <select id="p-category" class="form-control" style="flex: 1;">
                            <!-- Will be populated dynamically -->
                            <option value="أوكر وكوالين">أوكر وكوالين</option>
                            <option value="ديكورات">ديكورات</option>
                            <option value="إكسسوارات">إكسسوارات</option>
                        </select>
                        <button type="button" class="btn btn-secondary btn-icon" onclick="addNewCategoryPrompt()"
                            title="إضافة مجموعة جديدة">
                            <i class="fas fa-plus-circle"></i>
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label>الألوان (مفصولة بفاصلة - اختياري)</label>
                    <input type="text" id="p-color" placeholder="مثال: أسود, أبيض, أزرق" class="form-control">
                </div>
                <div class="form-group">
                    <label>المقاسات (مفصولة بفاصلة - اختياري)</label>
                    <input type="text" id="p-sizes" placeholder="مثال: 40, 41, 42, 43" class="form-control">
                </div>

                <!-- Variants Selection Section -->
                <div class="form-section"
                    style="margin-top: 20px; border: 1px solid #eee; padding: 15px; border-radius: 12px; background: #fafafa;">
                    <h4 style="margin-bottom: 15px; color: #2c3e50;"><i class="fas fa-tags"
                            style="margin-left: 8px;"></i>
                        إدارة المقاسات والكميات</h4>
                    <p class="text-muted small" style="margin-bottom: 10px;">أضف المقاسات المتوفرة وحدد السعر والكمية
                        المتاحة لكل مقاس. إذا لم تضف شيئاً، سيتم استخدام السعر والكمية الأساسية أعلاه.</p>
                    <div id="variants-container">
                        <!-- Variants will be added here -->
                    </div>
                    <button type="button" class="btn btn-secondary btn-small" onclick="addVariantRow()"
                        style="margin-top: 10px; width: 100%;">
                        <i class="fas fa-plus"></i> إضافة مقاس/سعر/كمية
                    </button>
                </div>
                <div class="form-group">
                    <label>صور المنتج (اسحب الصور هنا)</label>
                    <div class="drop-zone" id="image-drop-zone">
                        <i class="fas fa-cloud-upload-alt icon-upload"></i>
                        <span>اسحب الصور أو اضغط للاختيار</span>
                        <input type="file" id="p-images-input" multiple accept="image/*" style="display: none;">
                    </div>
                    <div class="image-previews" id="image-previews-container"></div>
                </div>

                <div class="form-group">
                    <label>وصف المنتج</label>
                    <div id="p-desc-editor" class="editor-container"></div>
                </div>

                <div class="modal-actions">
                    <button type="submit" class="btn btn-primary">حفظ</button>
                    <button type="button" class="btn btn-secondary" onclick="closeProductModal()">إلغاء</button>
                </div>
            </form>
        </div>
    </div>


    <!-- Staff Invite Modal -->
    <div id="invite-modal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <h3 style="margin-bottom: 1rem; color: #2ecc71; text-align: center;"><i class="fas fa-check-circle"></i> تم
                إنشاء الحساب بنجاح</h3>
            <p style="text-align: center; color: #666; margin-bottom: 1.5rem;">يرجى نسخ رابط الدعوة وبيانات الدخول
                وإرسالها للموظف.</p>

            <div
                style="background: #f8f9fa; padding: 15px; border-radius: 8px; border: 1px solid #ddd; margin-bottom: 1rem;">
                <label style="display: block; font-weight: bold; margin-bottom: 5px;">رابط الدخول:</label>
                <div style="display: flex; gap: 5px;">
                    <input type="text" id="inv-link" readonly
                        style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; direction: ltr;">
                    <button onclick="copyInvite('link')" class="btn-action"
                        style="background: #3498db; color: white; width: 40px;"><i class="fas fa-copy"></i></button>
                </div>
            </div>

            <div
                style="background: #f8f9fa; padding: 15px; border-radius: 8px; border: 1px solid #ddd; margin-bottom: 1rem;">
                <div style="margin-bottom: 10px;">
                    <label style="display: block; font-weight: bold; margin-bottom: 5px;">البريد الإلكتروني:</label>
                    <div style="display: flex; gap: 5px;">
                        <input type="text" id="inv-email" readonly
                            style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; direction: ltr;">
                        <button onclick="copyInvite('email')" class="btn-action"
                            style="background: #3498db; color: white; width: 40px;"><i class="fas fa-copy"></i></button>
                    </div>
                </div>
                <div>
                    <label style="display: block; font-weight: bold; margin-bottom: 5px;">كلمة المرور:</label>
                    <div style="display: flex; gap: 5px;">
                        <input type="text" id="inv-pass" readonly
                            style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; direction: ltr;">
                        <button onclick="copyInvite('pass')" class="btn-action"
                            style="background: #3498db; color: white; width: 40px;"><i class="fas fa-copy"></i></button>
                    </div>
                </div>
            </div>


            <button class="btn btn-secondary"
                onclick="document.getElementById('invite-modal').classList.remove('active')"
                style="width: 100%;">إغلاق</button>
        </div>
    </div>

    <!-- Manual Order Modal -->
    <!-- Bulk WhatsApp Modal -->
    <div id="bulk-whatsapp-modal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2><i class="fab fa-whatsapp"></i> إرسال رسالة جماعية</h2>
                <button class="close-modal" onclick="closeBulkWhatsAppModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="info-box" style="margin-bottom: 15px;">
                    <p style="font-size: 0.9rem; margin: 0;">هذه الخاصية تساعدك على مراسلة جميع عملائك. سيتم فتح محادثة
                        كل عميل بالترتيب.</p>
                </div>

                <div id="bulk-wa-setup">
                    <div class="form-group">
                        <label>نص الرسالة</label>
                        <textarea id="bulk-wa-message" class="form-control" rows="6"
                            placeholder="اكتب رسالتك هنا... استخدم {name} لوضع اسم العميل تلقائياً"></textarea>
                    </div>
                    <button class="btn btn-success w-100" onclick="startBulkWhatsApp()">
                        <i class="fas fa-play"></i> بدء عملية الإرسال
                    </button>
                </div>

                <div id="bulk-wa-progress" style="display: none; text-align: center; padding: 20px;">
                    <div class="progress-info" style="margin-bottom: 15px;">
                        <span id="bulk-wa-current-name"
                            style="font-weight: bold; display: block; font-size: 1.2rem;"></span>
                        <span id="bulk-wa-stats" style="color: #666;">العميل 1 من 10</span>
                    </div>
                    <div
                        style="background: #eee; height: 10px; border-radius: 5px; margin-bottom: 20px; overflow: hidden;">
                        <div id="bulk-wa-bar"
                            style="background: #25D366; height: 100%; width: 0%; transition: width 0.3s;"></div>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary flex-1" onclick="sendToCurrentCustomer()">
                            <i class="fab fa-whatsapp"></i> إرسال الآن
                        </button>
                        <button class="btn btn-secondary" onclick="skipCurrentCustomer()">
                            تخطي
                        </button>
                    </div>
                    <button class="btn btn-secondary w-100" style="margin-top: 15px;" onclick="stopBulkWhatsApp()">
                        إيقاف مؤقت
                    </button>
                </div>
            </div>
        </div>
    </div>

    <style>
        /* Premium Custom Dropdown System */
        .mo-custom-dropdown {
            position: relative;
            width: 100%;
            user-select: none;
            font-family: 'Cairo', sans-serif;
        }

        .mo-dropdown-trigger {
            background: #fff;
            border: 2px solid #f0f0f0;
            padding: 12px 15px;
            border-radius: 12px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 0.95rem;
            color: #2c3e50;
            font-weight: 600;
        }

        .mo-dropdown-trigger:hover {
            border-color: var(--primary-color);
            background: #fcfdfd;
        }

        .mo-custom-dropdown.active .mo-dropdown-trigger {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(72, 107, 101, 0.1);
            border-bottom-left-radius: 0;
            border-bottom-right-radius: 0;
        }

        .mo-dropdown-trigger i {
            font-size: 0.8rem;
            color: #999;
            transition: transform 0.3s;
        }

        .mo-custom-dropdown.active .mo-dropdown-trigger i {
            transform: rotate(180deg);
            color: var(--primary-color);
        }

        .mo-dropdown-menu {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid var(--primary-color);
            border-top: none;
            border-bottom-left-radius: 12px;
            border-bottom-right-radius: 12px;
            z-index: 99999;
            max-height: 250px;
            overflow-y: auto;
            display: none;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            animation: dropdownSlide 0.2s ease-out;
        }

        @keyframes dropdownSlide {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .mo-custom-dropdown.active .mo-dropdown-menu {
            display: block;
        }

        .mo-dropdown-search {
            padding: 10px;
            border-bottom: 1px solid #eee;
            position: sticky;
            top: 0;
            background: white;
            z-index: 1;
        }

        .mo-dropdown-search input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #eee;
            border-radius: 8px;
            font-size: 0.85rem;
            outline: none;
        }

        .mo-dropdown-search input:focus {
            border-color: var(--primary-color);
        }

        .mo-dropdown-option {
            padding: 12px 15px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
            color: #444;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .mo-dropdown-option:hover {
            background: #f0f7f6;
            color: var(--primary-color);
            padding-right: 20px;
        }

        .mo-dropdown-option.selected {
            background: var(--primary-color);
            color: white;
        }

        .mo-dropdown-option.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: #f9f9f9;
        }

        /* Scrollbar Styling */
        .mo-dropdown-menu::-webkit-scrollbar {
            width: 6px;
        }

        .mo-dropdown-menu::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        .mo-dropdown-menu::-webkit-scrollbar-thumb {
            background: #ccc;
            border-radius: 10px;
        }

        .mo-dropdown-menu::-webkit-scrollbar-thumb:hover {
            background: var(--primary-color);
        }

        .mo-item-row {
            background: #fff;
            padding: 15px !important;
            border-radius: 15px !important;
            border: 1.5px solid #f0f0f0 !important;
            margin-bottom: 20px !important;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.03);
        }
    </style>

    <div id="manual-order-modal" class="modal">
        <div class="modal-content"
            style="max-width: 850px; border-radius: 24px; padding: 30px; max-height: 90vh; overflow-y: auto;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                <h3 style="margin: 0; font-size: 1.6rem; color: #2c3e50; font-weight: 800;">
                    <i class="fas fa-plus-circle" style="color: var(--primary-color); margin-left: 10px;"></i>
                    إنشاء طلب يدوي جديد
                </h3>
                <button type="button" class="btn-close" onclick="closeManualOrderModal()"
                    style="background: #f8f9fa; border: none; width: 40px; height: 40px; border-radius: 50%; font-size: 1.2rem; cursor: pointer; color: #999; display: flex; align-items: center; justify-content: center; transition: all 0.3s;">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="manual-order-form">
                <div class="stats-grid" style="grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label style="font-weight: 700; color: #34495e; margin-bottom: 8px; display: block;">اسم
                            العميل</label>
                        <input type="text" id="mo-name" required placeholder="مثال: محمد أحمد"
                            style="border: 2px solid #f0f0f0; border-radius: 12px; padding: 12px;">
                    </div>
                    <div class="form-group">
                        <label style="font-weight: 700; color: #34495e; margin-bottom: 8px; display: block;">رقم
                            العميل</label>
                        <input type="text" id="mo-phone" required placeholder="01xxxxxxxxx"
                            style="border: 2px solid #f0f0f0; border-radius: 12px; padding: 12px;">
                    </div>
                </div>

                <div class="stats-grid" style="grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 15px;">
                    <div class="form-group">
                        <label
                            style="font-weight: 700; color: #34495e; margin-bottom: 8px; display: block;">المحافظة</label>
                        <div id="mo-gov-dropdown" class="mo-custom-dropdown">
                            <div class="mo-dropdown-trigger">
                                <span>اختر المحافظة...</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="mo-dropdown-menu">
                                <!-- Options will be populated by JS -->
                            </div>
                            <input type="hidden" id="mo-governorate" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label style="font-weight: 700; color: #34495e; margin-bottom: 8px; display: block;">العنوان
                            بالتفصيل</label>
                        <input type="text" id="mo-address" required placeholder="الحي، الشارع، المبنى..."
                            style="border: 2px solid #f0f0f0; border-radius: 12px; padding: 12px;">
                    </div>
                </div>

                <h4
                    style="margin: 2rem 0 1rem; border-bottom: 2px solid #f0f0f0; padding-bottom: 10px; color: #2c3e50; display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-shopping-basket" style="color: var(--primary-color);"></i>
                    المنتجات المطلوبة
                </h4>

                <div id="mo-items-container"
                    style="padding: 10px; margin-bottom: 1.5rem; position: relative; overflow: visible !important;">
                    <!-- Product Rows -->
                </div>

                <button type="button" class="btn btn-secondary" onclick="addOrderItemRow()"
                    style="width: 100%; margin-bottom: 2rem; border-style: dashed; background: #f8f9fa; color: #666; position: relative; z-index: 1;">
                    <i class="fas fa-plus-circle" style="margin-left: 8px;"></i> إضافة منتج آخر للطلب
                </button>

                <div
                    style="background: #fdfdfd; padding: 20px; border-radius: 15px; border: 1px solid #eee; position: relative; z-index: 2005;">
                    <div class="stats-grid" style="grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
                        <div class="form-group">
                            <label>طريقة الدفع</label>
                            <select id="mo-payment" class="mo-select-modern" style="width: 100%;">
                                <option value="Cash on Delivery">دفع عند الاستلام</option>
                                <option value="Vodafone Cash">فودافون كاش</option>
                                <option value="InstaPay">إنستا باي</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>تكلفة الشحن</label>
                            <div style="position: relative;">
                                <input type="number" id="mo-shipping-cost" readonly
                                    style="background: #f8f9fa; padding-right: 35px;">
                                <i class="fas fa-truck"
                                    style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); color: #999;"></i>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>إجمالي الطلب</label>
                            <div style="position: relative;">
                                <input type="number" id="mo-total" readonly
                                    style="background: #f0f7f6; color: var(--primary-color); font-weight: 900; font-size: 1.2rem; padding-right: 35px; border-color: var(--primary-color);">
                                <i class="fas fa-calculator"
                                    style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); color: var(--primary-color);"></i>
                            </div>
                        </div>
                    </div>

                </div>

                <div style="display: flex; gap: 1rem; margin-top: 2rem; position: relative; z-index: 2010;">
                    <button type="button" onclick="submitManualOrder()" class="btn btn-primary"
                        style="flex: 2; height: 50px; font-size: 1.1rem; box-shadow: 0 4px 15px rgba(72, 107, 101, 0.3); cursor: pointer;">إتمام
                        إنشاء الطلب</button>
                    <button type="button" class="btn btn-secondary" onclick="closeManualOrderModal()"
                        style="flex: 1; height: 50px; background: #f0f0f0; color: #666; border: none; cursor: pointer;">إلغاء</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Shipping Modal -->
    <div id="shipping-modal" class="modal">
        <div class="modal-content">
            <h3>إضافة / تعديل منطقة شحن</h3>
            <form id="shipping-form">
                <input type="hidden" id="sh-id">

                <div class="form-group">
                    <label>المنطقة أو المحافظة</label>
                    <input type="text" id="sh-city" required placeholder="مثال: أسيوط" class="form-control">
                </div>
                <div class="form-group">
                    <label>السعر الأساسي (لكل الطلب)</label>
                    <input type="number" id="sh-rate" required min="0" class="form-control" placeholder="60">
                </div>
                <div style="display: flex; gap: 1rem;">
                    <button type="submit" class="btn btn-primary" style="flex: 1;">حفظ</button>
                    <button type="button" class="btn btn-secondary" onclick="closeShippingModal()"
                        style="flex: 1;">إلغاء</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Keyword Input Modal -->
    <div id="keyword-modal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <h2 style="margin-bottom: 1.5rem; color: #2c3e50; display: flex; align-items: center; gap: 10px;">
                <i class="fas fa-key" style="color: #667eea;"></i>
                إضافة كلمة مفتاحية
            </h2>

            <div
                style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                <p style="margin: 0; color: white; font-size: 0.9rem;">
                    <i class="fas fa-lightbulb" style="margin-left: 5px;"></i>
                    استخدم كلمات متنوعة بالعربي والإنجليزي لتحسين ظهور متجرك في نتائج البحث
                </p>
            </div>

            <div class="form-group">
                <label style="font-weight: 600; color: #2c3e50; margin-bottom: 8px; display: block;">
                    <i class="fas fa-edit" style="margin-left: 5px; color: #3498db;"></i>
                    الكلمة المفتاحية
                </label>
                <input type="text" id="keyword-input" class="form-control"
                    placeholder="مثال: اكسسوارات موبيليا، مقابض أبواب، الشرقاوي..."
                    style="font-size: 1rem; padding: 14px;" autofocus>
                <small style="color: #7f8c8d; display: block; margin-top: 8px;">
                    <i class="fas fa-info-circle"></i>
                    يمكنك إضافة كلمات بالعربي أو الإنجليزي
                </small>
            </div>

            <div style="display: flex; gap: 10px; margin-top: 25px;">
                <button class="btn btn-primary" onclick="submitKeyword()" style="flex: 1;">
                    <i class="fas fa-plus"></i>
                    إضافة
                </button>
                <button class="btn btn-secondary" onclick="closeKeywordModal()" style="flex: 1;">
                    <i class="fas fa-times"></i>
                    إلغاء
                </button>
            </div>
        </div>
    </div>

    <!-- SEO Guide Modal -->
    <div id="seo-guide-modal" class="modal">
        <div class="modal-content"
            style="max-width: 850px; padding: 0; overflow: hidden; display: flex; flex-direction: column; border-radius: 20px; border: none; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);">
            <div
                style="padding: 25px 30px; background: linear-gradient(135deg, #3498db 0%, #2c3e50 100%); color: white; display: flex; justify-content: space-between; align-items: center; position: relative;">
                <div style="display: flex; align-items: center; gap: 15px;">
                    <div
                        style="width: 45px; height: 45px; background: rgba(255,255,255,0.2); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem;">
                        <i class="fas fa-book-open"></i>
                    </div>
                    <div>
                        <h3 id="seo-guide-title" style="margin: 0; color: white; font-size: 1.4rem; font-weight: 800;">
                            دليل SEO</h3>
                        <p style="margin: 0; font-size: 0.85rem; opacity: 0.8;">مركز المساعدة والتحسين</p>
                    </div>
                </div>
                <button onclick="closeSEOGuide()"
                    style="background: rgba(255,255,255,0.1); border: none; color: white; width: 35px; height: 35px; border-radius: 10px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease;">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="seo-guide-content" class="seo-guide-body">
                <!-- Content will be injected here -->
            </div>
            <div
                style="padding: 20px 30px; background: #f8f9fa; border-top: 1px solid #eee; display: flex; justify-content: flex-end;">
                <button class="btn btn-primary" onclick="closeSEOGuide()"
                    style="padding: 10px 30px; border-radius: 10px;">فهمت ذلك</button>
            </div>
        </div>
    </div>

    <style>
        .seo-guide-body {
            padding: 40px;
            overflow-y: auto;
            max-height: 70vh;
            line-height: 1.8;
            text-align: right;
            direction: rtl;
            background: white;
            color: #2c3e50;
        }

        .seo-guide-body h2 {
            color: #2c3e50;
            font-size: 1.8rem;
            font-weight: 900;
            margin-bottom: 25px;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            display: inline-block;
        }

        .seo-guide-body h3 {
            color: #34495e;
            font-size: 1.3rem;
            margin-top: 30px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .seo-guide-body p {
            margin-bottom: 15px;
            font-size: 1.05rem;
            color: #555;
        }

        .seo-guide-body hr {
            border: 0;
            height: 1px;
            background: #eee;
            margin: 30px 0;
        }

        .seo-guide-body ul {
            padding-right: 25px;
            margin-bottom: 20px;
        }

        .seo-guide-body li {
            margin-bottom: 10px;
            position: relative;
        }

        .seo-guide-body .info-box {
            background: #e3f2fd;
            border-right: 5px solid #2196f3;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
        }

        .seo-guide-body .success-box {
            background: #e8f5e9;
            border-right: 5px solid #4caf50;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
        }

        .seo-guide-body .step-card {
            background: white;
            border: 1px solid #e0e0e0;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .seo-guide-body .step-card:hover {
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border-color: #3498db;
        }

        .seo-guide-body code {
            background: #f1f1f1;
            padding: 4px 10px;
            border-radius: 6px;
            font-family: monospace;
            color: #e74c3c;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .seo-guide-body a {
            color: #3498db;
            text-decoration: none;
            font-weight: 700;
        }

        .seo-guide-body a:hover {
            text-decoration: underline;
        }
    </style>


    <!-- SEO Section Scripts -->
    <script>
        // SEO Data Storage
        let seoKeywords = [];
        const SUGGESTED_KEYWORDS = [
            'اكسسوارات موبيليا', 'مقابض أبواب', 'مفصلات مطابخ', 'مجاري أدراج',
            'مقابض دواليب', 'مقابض مودرن', 'مستلزمات نجارة', 'مقابض كلاسيك',
            'ترابيس أبواب', 'إكسسوارات غرف نوم', 'مستلزمات موبيليا في مصر',
            'أفضل محل مقابض', 'شحن اكسسوارات موبيليا', 'متجر الشرقاوي',
            'Elsharkawy Store', 'الشرقاوي لاكسسوارات الأثاث'
        ];
        let seoMetaData = {
            title: '',
            description: '',
            googleVerify: ''
        };

        // Initialize SEO Section
        function initSEO() {
            // Load saved data
            const savedKeywords = localStorage.getItem('seo_keywords');
            const savedMeta = localStorage.getItem('seo_meta');

            if (savedKeywords) {
                seoKeywords = JSON.parse(savedKeywords);
            }

            if (savedMeta) {
                seoMetaData = JSON.parse(savedMeta);
                document.getElementById('meta-title').value = seoMetaData.title || '';
                document.getElementById('meta-description').value = seoMetaData.description || '';
                document.getElementById('google-verify-code').value = seoMetaData.googleVerify || '';
            }

            renderKeywords();
            renderSuggestedKeywords();
            updateKeywordsCount();
            updateCharacterCounters();
            updateGoogleVerifyStatus();

            // Add event listeners for character counters
            document.getElementById('meta-title').addEventListener('input', updateCharacterCounters);
            document.getElementById('meta-description').addEventListener('input', updateCharacterCounters);
        }

        // Add Keyword - Open Modal
        function addKeyword() {
            document.getElementById('keyword-modal').classList.add('active');
            document.getElementById('keyword-input').value = '';
            document.getElementById('keyword-input').focus();
        }

        // Close Keyword Modal
        function closeKeywordModal() {
            document.getElementById('keyword-modal').classList.remove('active');
            document.getElementById('keyword-input').value = '';
        }

        // Submit Keyword
        function submitKeyword() {
            const keyword = document.getElementById('keyword-input').value.trim();
            if (keyword) {
                if (!seoKeywords.includes(keyword)) {
                    seoKeywords.push(keyword);
                    saveKeywords();
                    renderKeywords();
                    renderSuggestedKeywords();
                    updateKeywordsCount();
                    closeKeywordModal();
                    showToast('تمت إضافة الكلمة المفتاحية بنجاح', 'success');
                } else {
                    showToast('هذه الكلمة موجودة بالفعل', 'error');
                }
            } else {
                showToast('يرجى إدخال كلمة مفتاحية', 'error');
            }
        }

        // Handle Enter key in keyword input
        document.addEventListener('DOMContentLoaded', function () {
            const keywordInput = document.getElementById('keyword-input');
            if (keywordInput) {
                keywordInput.addEventListener('keypress', function (e) {
                    if (e.key === 'Enter') {
                        submitKeyword();
                    }
                });
            }
        });

        // Add Suggested Keyword
        function addSuggestedKeyword(keyword) {
            if (!seoKeywords.includes(keyword)) {
                seoKeywords.push(keyword);
                saveKeywords();
                renderKeywords();
                renderSuggestedKeywords();
                updateKeywordsCount();
                showToast(`تمت إضافة "${keyword}" بنجاح`, 'success');
            } else {
                showToast('هذه الكلمة موجودة بالفعل', 'info');
            }
        }

        // Render Suggested Keywords
        function renderSuggestedKeywords() {
            const container = document.getElementById('suggested-keywords-container');
            if (!container) return;

            const filteredSuggestions = SUGGESTED_KEYWORDS.filter(k => !seoKeywords.includes(k));

            if (filteredSuggestions.length === 0) {
                container.innerHTML = '<p style="color: #7f8c8d; font-size: 0.9rem; text-align: center; width: 100%;">تمت إضافة جميع الكلمات المقترحة</p>';
                return;
            }

            container.innerHTML = filteredSuggestions.map(keyword => `
                <span class="suggested-keyword" onclick="addSuggestedKeyword('${keyword}')">${keyword}</span>
            `).join('');
        }

        // Remove Keyword
        function removeKeyword(index) {
            const keyword = seoKeywords[index];
            showConfirm(
                `هل تريد حذف الكلمة المفتاحية "${keyword}"؟`,
                () => {
                    seoKeywords.splice(index, 1);
                    saveKeywords();
                    renderKeywords();
                    renderSuggestedKeywords();
                    updateKeywordsCount();
                    showToast('تم حذف الكلمة المفتاحية', 'success');
                }
            );
        }

        // Render Keywords
        function renderKeywords() {
            const container = document.getElementById('keywords-container');
            if (seoKeywords.length === 0) {
                container.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: #7f8c8d;">
                        <i class="fas fa-key" style="font-size: 3rem; opacity: 0.3; margin-bottom: 15px;"></i>
                        <p style="margin: 0;">لم تقم بإضافة أي كلمات مفتاحية بعد</p>
                        <p style="margin: 10px 0 0 0; font-size: 0.9rem;">استخدم الكلمات المقترحة أدناه أو أضف كلمات خاصة بك</p>
                    </div>
                `;
                renderSuggestedKeywords();
                return;
            }

            container.innerHTML = seoKeywords.map((keyword, index) => `
                <div class="keyword-tag">
                    <span>${keyword}</span>
                    <button class="remove-keyword" onclick="removeKeyword(${index})" style="color: #e74c3c; margin-right: 5px;">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `).join('');

            // Always sync suggested keywords
            renderSuggestedKeywords();
        }

        // Save Keywords
        function saveKeywords() {
            localStorage.setItem('seo_keywords', JSON.stringify(seoKeywords));
        }

        // Update Keywords Count
        function updateKeywordsCount() {
            document.getElementById('keywords-count').textContent = seoKeywords.length;
        }

        // Save Meta Tags
        function saveMetaTags() {
            const title = document.getElementById('meta-title').value.trim();
            const description = document.getElementById('meta-description').value.trim();
            const googleVerify = document.getElementById('google-verify-code').value.trim();

            if (!title) {
                showToast('يرجى إدخال عنوان الموقع', 'error');
                return;
            }

            if (!description) {
                showToast('يرجى إدخال وصف الموقع', 'error');
                return;
            }

            seoMetaData = {
                title,
                description,
                googleVerify
            };

            localStorage.setItem('seo_meta', JSON.stringify(seoMetaData));

            // Also save to site_settings for compatibility
            const settings = db.getSettings();
            settings.googleVerify = googleVerify;
            db.saveSettings(settings);

            updateGoogleVerifyStatus();
            showToast('تم حفظ التغييرات بنجاح', 'success');
        }

        // Update Character Counters
        function updateCharacterCounters() {
            const titleLength = document.getElementById('meta-title').value.length;
            const descLength = document.getElementById('meta-description').value.length;

            document.getElementById('title-length').textContent = titleLength;
            document.getElementById('desc-length').textContent = descLength;

            // Color coding
            const titleLengthEl = document.getElementById('title-length');
            const descLengthEl = document.getElementById('desc-length');

            titleLengthEl.style.color = titleLength > 60 ? '#e74c3c' : titleLength > 50 ? '#f39c12' : '#27ae60';
            descLengthEl.style.color = descLength > 160 ? '#e74c3c' : descLength > 150 ? '#f39c12' : '#27ae60';
        }

        // Update Google Verify Status
        function updateGoogleVerifyStatus() {
            const statusEl = document.getElementById('google-verify-status');
            const googleVerify = document.getElementById('google-verify-code').value.trim();

            if (googleVerify) {
                statusEl.innerHTML = '<i class="fas fa-check-circle" style="color: #27ae60;"></i> مفعّل';
                statusEl.style.color = '#27ae60';
            } else {
                statusEl.innerHTML = '<i class="fas fa-times-circle" style="color: #e74c3c;"></i> غير مفعّل';
                statusEl.style.color = '#e74c3c';
            }
        }

        // View Sitemap
        function viewSitemap() {
            window.open('../sitemap.xml', '_blank');
        }

        // Copy Sitemap Link
        function copySitemapLink() {
            const sitemapUrl = window.location.origin + '/sitemap.xml';
            navigator.clipboard.writeText(sitemapUrl).then(() => {
                showToast('تم نسخ رابط Sitemap بنجاح', 'success');
            }).catch(() => {
                showAlert('فشل نسخ الرابط. الرابط هو: ' + sitemapUrl, 'error');
            });
        }

        // View Robots.txt
        function viewRobots() {
            window.open('../robots.txt', '_blank');
        }

        // Copy Robots Link
        function copyRobotsLink() {
            const robotsUrl = window.location.origin + '/robots.txt';
            navigator.clipboard.writeText(robotsUrl).then(() => {
                showToast('تم نسخ رابط Robots.txt بنجاح', 'success');
            }).catch(() => {
                showAlert('فشل نسخ الرابط. الرابط هو: ' + robotsUrl, 'error');
            });
        }

        // Open SEO Guide
        function openSEOGuide(filename) {
            const titles = {
                'SEO_README.md': '📚 دليل البداية',
                'SEARCH_ENGINE_STEPS.md': '✅ خطوات عملية',
                'KEYWORDS.md': '🔑 الكلمات المفتاحية',
                'SEO_GUIDE.md': '📖 الدليل الشامل'
            };

            const guideContent = {
                'SEO_README.md': `
                < h2 >📚 دليل البدء السريع لـ SEO</h2 >
                    <p>أهلاً بك في مركز تحسين محركات البحث. لقد قمنا بتجهيز متجرك تقنياً ليكون صديقاً لجوجل، وهذه الأدلة ستساعدك على إكمال المسيرة.</p>
                    
                    <div class="info-box">
                        <strong>🎯 الهدف:</strong> الوصول للصفحة الأولى في نتائج البحث وزيادة المبيعات بشكل مجاني.
                    </div>

                    <div class="step-card">
                        <h3><i class="fas fa-map-signs" style="color: #3498db;"></i> خريطة الطريق</h3>
                        <p>نوصي بقراءة الأدلة بالترتيب التالي للحصول على أفضل النتائج:</p>
                        <ul style="list-style-type: none; padding-right: 10px;">
                            <li><i class="fas fa-check-circle" style="color: #27ae60; margin-left: 10px;"></i> <strong>خطوات عملية:</strong> للبدء فوراً في تسجيل موقعك.</li>
                            <li><i class="fas fa-key" style="color: #f1c40f; margin-left: 10px;"></i> <strong>الكلمات المفتاحية:</strong> لتعرف ماذا يكتب الزوار للوصول إليك.</li>
                            <li><i class="fas fa-graduation-cap" style="color: #9b59b6; margin-left: 10px;"></i> <strong>الدليل الشامل:</strong> لفهم أعمق لكيفية عمل SEO المتجر.</li>
                        </ul>
                    </div>

                    <div class="success-box">
                        <i class="fas fa-lightbulb" style="margin-left: 10px;"></i>
                        <strong>نصيحة ذهبية:</strong> الاستمرار في إضافة منتجات جديدة وتحديث الأوصاف هو مفتاح النجاح في جوجل.
                    </div>
            `,
                'SEARCH_ENGINE_STEPS.md': `
                < h2 >✅ خطوات الظهور في محركات البحث</h2 >
                    <p>اتبع هذه الخطوات الثلاث الأساسية لتبدأ في جلب الزوار من جوجل و Bing.</p>

                    <div class="step-card">
                        <h3><span style="background: #3498db; color: white; width: 28px; height: 28px; display: inline-flex; align-items: center; justify-content: center; border-radius: 50%; font-size: 0.9rem; margin-left: 10px;">1</span> جوجل (Search Console)</h3>
                        <p>هذا هو أهم حساب يجب أن تمتلكه:</p>
                        <ul>
                            <li>افتح: <a href="https://search.google.com/search-console" target="_blank">Google Search Console</a></li>
                            <li>أضف موقعك: <code>https://elsharkawystore.com</code></li>
                            <li>في الإعدادات هنا، الصق كود التحقق في خانة <strong>Google Verification Code</strong> في الإعدادات.</li>
                        </ul>
                    </div>

                    <div class="step-card">
                        <h3><span style="background: #e67e22; color: white; width: 28px; height: 28px; display: inline-flex; align-items: center; justify-content: center; border-radius: 50%; font-size: 0.9rem; margin-left: 10px;">2</span> أرسل خريطة الموقع (Sitemap)</h3>
                        <p>داخل حساب جوجل للبحث، ابحث عن "Sitemaps" وأضف الرابط:</p>
                        <div style="background: #f9f9f9; padding: 10px; border-radius: 8px; font-family: monospace; text-align: center; margin: 10px 0; direction: ltr;">
                            https://elsharkawystore.com/sitemap.xml
                        </div>
                    </div>

                    <div class="step-card">
                        <h3><span style="background: #27ae60; color: white; width: 28px; height: 28px; display: inline-flex; align-items: center; justify-content: center; border-radius: 50%; font-size: 0.9rem; margin-left: 10px;">3</span> تحديث المحتوى</h3>
                        <p>عند إضافة أي منتج جديد، جوجل سيلاحظه تلقائياً. لكن إعادة إرسال الـ Sitemap يجعل الأمر أسرع.</p>
                    </div>
            `,
                'KEYWORDS.md': `
                < h2 >🔑 أسرار الكلمات المفتاحية</h2 >
                    <p>الكلمات المفتاحية هي الكلمات التي يستخدمها العميل في جوجل ليجد متجرك.</p>

                    <h3 style="color: #27ae60;"><i class="fas fa-star"></i> الكلمات الأكثر أهمية</h3>
                    <div style="display: flex; flex-wrap: wrap; gap: 10px; margin: 15px 0;">
                        <span style="background: #f1f9f1; color: #27ae60; padding: 5px 15px; border-radius: 50px; border: 1px solid #d4edda; font-weight: bold;">متجر الشرقاوي</span>
                        <span style="background: #f1f9f1; color: #27ae60; padding: 5px 15px; border-radius: 50px; border: 1px solid #d4edda; font-weight: bold;">مقابض أبواب مودرن</span>
                        <span style="background: #f1f9f1; color: #27ae60; padding: 5px 15px; border-radius: 50px; border: 1px solid #d4edda; font-weight: bold;">اكسسوارات موبيليا</span>
                        <span style="background: #f1f9f1; color: #27ae60; padding: 5px 15px; border-radius: 50px; border: 1px solid #d4edda; font-weight: bold;">أفضل محل مقابض</span>
                    </div>

                    <div class="info-box" style="background: #fff8e1; border-right-color: #ffc107;">
                        <h4 style="margin: 0 0 10px; color: #856404;"><i class="fas fa-pencil-alt"></i> كيف تستخدمها؟</h4>
                        <p style="margin: 0; color: #856404; font-size: 0.95rem;">ضع هذه الكلمات داخل <strong>وصف المنتج</strong> بشكل طبيعي. مثلاً: "تعتبر هذه المقابض هي الأفضل في متجر الشرقاوي لاكسسوارات الأثاث..."</p>
                    </div>

                    <h3><i class="fas fa-language" style="color: #3498db;"></i> لا تنسَ الإنجليزية!</h3>
                    <p>الكثير من الناس يبحثون بالإنجليزية. تأكد من استخدام كلمات مثل:</p>
                    <ul style="column-count: 2;">
                        <li>Elsharkawy Store</li>
                        <li>Furniture Accessories</li>
                        <li>Door Handles</li>
                        <li>Best Hardware Shop</li>
                    </ul>
            `,
                'SEO_GUIDE.md': `
                < h2 >📖 الدليل التقني الشامل</h2 >
                    <p>لقد صممنا النظام ليعمل خلف الكواليس لضمان أفضل ترتيب ممكن.</p>

                    <div class="step-card">
                        <h3><i class="fas fa-code-branch" style="color: #3498db;"></i> الهيكل التقني</h3>
                        <ul>
                            <li><strong>Robots.txt:</strong> ملف موجه لآلات جوجل لنخبرهم أين يبحثون.</li>
                            <li><strong>Sitemap:</strong> خريطة ذكية بكل محتويات متجرك.</li>
                            <li><strong>Structured Data:</strong> لغة خاصة تجعل جوجل يفهم أن هذا "منتج" وله "سعر".</li>
                        </ul>
                    </div>

                    <div class="step-card">
                        <h3><i class="fas fa-mobile-alt" style="color: #e74c3c;"></i> التوافق مع الهواتف</h3>
                        <p>متجرك متوافق بنسبة 100% مع الجوال، وهو أمر يعشقه جوجل في عام 2026.</p>
                    </div>

                    <div class="info-box" style="background: #f3e5f5; border-right-color: #9c27b0;">
                        <h4 style="margin: 0 0 10px; color: #4a148c;"><i class="fas fa-rocket"></i> الخطوة القادمة؟</h4>
                        <p style="margin: 0; color: #4a148c; font-size: 0.95rem;">استمر في مراقبة "الإحصائيات" لتعرف من أين يأتي زوارك الحقيقيون.</p>
                    </div>
                `
            };

            const content = guideContent[filename] || '<p>عذراً، لم يتم العثور على محتوى لهذا الدليل.</p>';
            const title = titles[filename] || 'دليل SEO';

            document.getElementById('seo-guide-title').innerText = title;
            document.getElementById('seo-guide-content').innerHTML = content;
            document.getElementById('seo-guide-modal').classList.add('active');
        }

        // Close SEO Guide
        function closeSEOGuide() {
            document.getElementById('seo-guide-modal').classList.remove('active');
        }
    </script>
    <!-- App Lock Modal (The PIN Screen) -->
    <div id="app-lock-modal" class="modal"
        style="background: rgba(44, 62, 80, 0.98); backdrop-filter: blur(10px); z-index: 10000; overflow: hidden;">
        <div class="lock-screen-content"
            style="text-align: center; color: white; width: 100%; max-width: 400px; padding: 20px;">
            <div class="user-avatar"
                style="width: 100px; height: 100px; background: rgba(255,255,255,0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 30px auto; border: 2px solid #3498db;">
                <i class="fas fa-lock" style="font-size: 2.5rem; color: #3498db;"></i>
            </div>
            <h2 id="lock-username" style="font-weight: 900; margin-bottom: 30px;">مدير الشرقاوي</h2>
            <div id="pin-display" style="display: flex; gap: 15px; justify-content: center; margin-bottom: 40px;">
                <div class="pin-dot" style="width: 15px; height: 15px; border-radius: 50%; border: 2px solid white;">
                </div>
                <div class="pin-dot" style="width: 15px; height: 15px; border-radius: 50%; border: 2px solid white;">
                </div>
                <div class="pin-dot" style="width: 15px; height: 15px; border-radius: 50%; border: 2px solid white;">
                </div>
                <div class="pin-dot" style="width: 15px; height: 15px; border-radius: 50%; border: 2px solid white;">
                </div>
            </div>

            <div class="numpad"
                style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; max-width: 320px; margin: 0 auto;">
                <button type="button" class="num-btn" onclick="appendPin('1')">1</button>
                <button type="button" class="num-btn" onclick="appendPin('2')">2</button>
                <button type="button" class="num-btn" onclick="appendPin('3')">3</button>
                <button type="button" class="num-btn" onclick="appendPin('4')">4</button>
                <button type="button" class="num-btn" onclick="appendPin('5')">5</button>
                <button type="button" class="num-btn" onclick="appendPin('6')">6</button>
                <button type="button" class="num-btn" onclick="appendPin('7')">7</button>
                <button type="button" class="num-btn" onclick="appendPin('8')">8</button>
                <button type="button" class="num-btn" onclick="appendPin('9')">9</button>
                <button type="button" class="num-btn" onclick="clearPin()" style="font-size: 1.2rem; color: #e74c3c;"><i
                        class="fas fa-times"></i></button>
                <button type="button" class="num-btn" onclick="appendPin('0')">0</button>
                <button type="button" class="num-btn" onclick="deletePin()" style="font-size: 1.2rem;"><i
                        class="fas fa-backspace"></i></button>
            </div>

            <style>
                .num-btn {
                    width: 75px;
                    height: 75px;
                    border-radius: 50%;
                    border: 1px solid rgba(255, 255, 255, 0.2);
                    background: rgba(255, 255, 255, 0.05);
                    color: white;
                    font-size: 1.8rem;
                    font-weight: 700;
                    cursor: pointer;
                    transition: all 0.2s;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    margin: 0 auto;
                }

                .num-btn:hover {
                    background: rgba(255, 255, 255, 0.2);
                    transform: scale(1.1);
                }

                .num-btn:active {
                    transform: scale(0.9);
                    background: var(--color-blue);
                }

                .pin-dot.filled {
                    background: white;
                }

                @keyframes shake {

                    0%,
                    100% {
                        transform: translateX(0);
                    }

                    25% {
                        transform: translateX(-10px);
                    }

                    50% {
                        transform: translateX(10px);
                    }

                    75% {
                        transform: translateX(-10px);
                    }
                }

                @media (max-width: 400px) {
                    .num-btn {
                        width: 65px;
                        height: 65px;
                        font-size: 1.5rem;
                    }

                    .numpad {
                        gap: 15px;
                    }
                }
            </style>
        </div>
    </div>


    <!-- Firebase SDK (Using jsDelivr CDN for better reliability) -->
    <script src="https://cdn.jsdelivr.net/npm/firebase@8.10.1/firebase-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/firebase@8.10.1/firebase-database.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/firebase@8.10.1/firebase-analytics.js"></script>

    <!-- Project Configs (Must load after SDK) -->
    <script src="../js/firebase-config.js"></script>
    <script src="../js/email-service.js"></script>
    <script src="../js/error-monitor.js"></script>
    <script src="../js/hybrid-adapter_v2.js"></script>

    <!-- Core Data Logic -->
    <script src="../js/data_v2.js?v=fix001"></script>
    <script src="../js/main.js"></script>
    <script src="../js/translations.js"></script>
    <script src="../js/admin_coupons.js"></script>
    <script src="../js/bosta-integration.js?v=32.0"></script>
    <script src="../js/bosta-admin.js"></script>

    <!-- SortableJS for Reordering -->
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <!-- Quill JS -->
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

    <!-- Admin Logic (Depends on all above) -->
    <script src="../js/admin_helpers.js"></script>
    <script src="../js/admin.js?v=fix002"></script>

    <script src="../js/mobile-app.js"></script>
</body>

</html>